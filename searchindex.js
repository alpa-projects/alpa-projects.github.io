Search.setIndex({docnames:["architecture/overview","architecture/parallelism-view-and-rationale","developer/developer_guide","gallery/tutorials/README","index","install/from_source","tutorials/advanced_api_usage","tutorials/alpa_vs_pmap","tutorials/getting_started","tutorials/index","tutorials/pipeshard_parallelism","tutorials/sg_execution_times"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["architecture/overview.rst","architecture/parallelism-view-and-rationale.rst","developer/developer_guide.rst","gallery/tutorials/README.rst","index.rst","install/from_source.rst","tutorials/advanced_api_usage.rst","tutorials/alpa_vs_pmap.rst","tutorials/getting_started.rst","tutorials/index.rst","tutorials/pipeshard_parallelism.rst","tutorials/sg_execution_times.rst"],objects:{},objnames:{},objtypes:{},terms:{"0":[6,7,8,10,11],"00":11,"000":[10,11],"001":7,"03":11,"069":[6,11],"0th":10,"1":[0,5,6,8,10],"10":8,"1024":8,"105":6,"11":5,"12":0,"1302":6,"145":8,"146":[],"152":[],"16":10,"16xlarg":0,"1e":[6,8,10],"1e3":8,"1st":10,"2":[0,6,8,10],"2048":[8,10],"21":[],"23":8,"24":[],"25":6,"2f":[6,8],"3":[0,5,6,8,10],"303":[],"31":[],"33":[],"36":[],"37":8,"39":[],"3d":6,"3f":6,"4":[0,6,8,10],"40":8,"41":[8,11],"421":[],"43":[],"44":11,"459":[8,11],"48":[],"49":8,"4x8":0,"5":8,"50":8,"512":6,"528":11,"54":[],"58":[],"59":8,"5e":[8,10],"64":6,"65":[],"7":[5,6],"8":[0,5,8],"86":8,"956":6,"968":[],"case":[0,5,6,10],"class":[0,6,8,10],"const":6,"default":[5,6],"do":[0,2,6,8],"export":5,"final":0,"function":[2,6,8,10],"import":6,"int":[8,10],"new":[0,6,10],"public":2,"return":[6,8,10],"static":0,"true":6,"try":0,"while":8,A:[0,7],As:6,At:0,By:8,For:[0,6],If:[6,7],In:[0,5,6,7,8,10],It:0,On:7,The:[0,2,6,7,8,10],Then:[2,10],There:2,These:0,To:[5,6,8,10],With:[0,6,7],_:6,__call__:[6,8,10],_loggingte:6,_privat:6,about:0,abov:[0,6,8],acceler:8,accord:8,accumul:10,achiev:7,actor:[0,10],actual:10,actual_st:8,adam:[6,8,10],add:6,addit:2,addition:0,address:10,adjac:0,advanc:[7,8,9,11],advanced_api_usag:[6,11],after:8,again:10,aim:0,algorithm:[0,10],all:[0,5,6,8,9],all_gath:8,all_thread:6,allreduc:6,along:0,alpa:[0,6,11],alpa_train_step:8,alpa_vs_pmap:[7,11],also:[0,6,7,8,10],altern:10,although:8,among:7,an:[6,7],analys:8,analyz:[0,7],ani:[0,2,8],anoth:0,api:[8,9,11],appli:[0,6,8,10],apply_fn:[6,8,10],apply_gradi:[6,8,10],approach:0,approxim:6,apt:5,ar:[0,2,5,6,7,8,10],arg:6,argument:8,arrai:8,art:8,articl:7,as_opt:6,as_option_backup:6,assert_allclos:[8,10],assign:[0,6,7,10],atol:[8,10],atom:6,attach:7,attention_mask:6,attribut:6,attributeerror:6,auto:10,auto_gpip:10,auto_pipeline_actual_st:10,auto_pipeline_train_step:10,autom:[7,10],automat:[2,5,6,7,8],automatic_layer_construct:[6,10],automatic_remat:6,autoshardingopt:6,avoid:[6,10],aw:0,ax:8,axi:0,b:[8,10],backup:6,backward:10,bandwidth:0,base:[0,6,10],bash:5,batch:[6,8,10],batch_siz:[6,8,10],becaus:[8,10],befor:0,begin:8,being:[8,10],below:[0,5,6,7,10],benchmark:[2,8],benchmark_func:8,bert:6,bert_config:6,bert_model:6,bertconfig:6,bertlayermodel:6,besid:[7,10],best:[7,8],better:7,between:[0,6,9,11],billion:7,binari:0,bodi:8,bool:6,both:[7,9,11],bring:0,build:[2,5],built:8,c:[2,5],call:[0,5,6,8],can:[0,5,6,7,8,10],cannot:7,categori:0,caus:6,cbc:5,cd:5,chang:[2,7],click:[6,7,8,10],client_mode_hook:6,clone:5,cluster:[8,10],cmake:5,coars:6,code:[0,5,6,7,8,9,10],coinor:5,com:5,combin:8,command:[5,10],common:7,commun:[0,6,8],compact:[8,10],compar:8,comparison:7,compil:[2,8],componen:0,comput:[6,7,8,10],config:[6,10],connect:[6,10],consist:[0,10],construct:10,consumpt:6,contain:0,contrari:7,control:10,convert:0,copi:[8,10],core:0,correct:[8,10],correspond:[0,6],cost:8,count_communication_primit:6,cover:6,cpu:10,creat:[6,8,10],create_train_st:6,cross:0,cuda111:5,cuda:5,cudnn:5,cupi:5,cupyx:5,custom:[0,5],data:[0,8,10],dataset:10,deadlock:6,decor:[6,8,10],deepcopi:10,deeper:0,def:[6,8,10],default_autosharding_opt:6,defin:[6,8,10],dens:[8,10],dense_0:8,depend:[0,5,8],describ:0,descript:0,design:[4,6,8],despit:0,detail:7,dev_instal:5,develop:5,devic:[6,7],device_clust:10,device_mesh:6,devicearrai:8,deviceclust:[6,10],diagram:0,differ:[0,8,9,11],dim:[8,10],dimens:6,dist:5,distinguish:0,distribut:[7,8,9,11],distributedli:8,dive:0,doc:[2,6],document:[0,2],doe:8,donate_argnum:8,download:[6,7,8,9,10],drive:0,driver:10,dtype:6,dure:[0,5],dynam:0,dynamic_scal:6,e:[5,6,10],each:[0,6,10],easier:2,ef:6,effect:5,effici:8,els:8,enabl:[6,10],enable_cuda:5,end:[6,7,10],ensur:10,entail:0,enumer:6,equalmanuallayerbertlayermodel:6,etc:0,exactli:0,exampl:[2,6,7,8,9,10],exclud:6,execut:[0,6,10,11],exist:[0,10],expected_st:[8,10],experiment:2,expertis:8,explain:0,express:0,extract:0,f:[6,8],fact:0,fall:0,fals:6,faster:8,faulthandl:6,featur:[7,8,10],few:0,figur:0,file:[6,11],fileno:6,find:8,fine:6,first:[0,6,8,10],fit:10,flax:[5,6,8,10],flaxbertlay:6,flexflow:0,float32:6,focus:10,folder:2,follow:[0,2,5,10],forc:10,force_batch_dim_to_mesh_dim:6,force_data_parallel:6,forcibl:6,fork:[2,5],form:[0,6,7,10],forward:[6,10],forward_stage_layer_id:6,four:[0,6],from:[0,6,8,10],full:[0,6,7,8,10],fullfil:0,fulli:8,func:6,functool:8,g:6,galleri:[6,7,8,9,10],gather:6,gb:[6,8],gener:[0,6,7,8,9,10],get:[9,10,11],get_execut:[6,8,10],get_hlo_text:6,get_physical_mesh:6,get_ray_namespace_str:6,get_total_allocation_s:8,get_train_step:6,get_virtual_physical_mesh:[6,10],getting_start:[8,11],git:5,github:5,give:6,given:[6,8],global:[6,8],global_config:6,global_config_backup:6,glpk:5,go:7,googl:2,gpu:[0,8,10],grad:[6,8,10],gradient:10,grain:6,graph:[7,8,10],ground:[8,10],group:0,gspmd:0,guarante:0,guid:10,ha:[6,8],have:0,head:5,henc:0,here:[6,7,8,10],hidden_dim:[8,10],hidden_s:6,hierarchi:0,high:[0,8],hlo:0,hlo_text:6,home:6,how:[0,10],howev:[7,8],hyperparamet:10,i:[6,8,10],illustr:0,ilp:5,immedi:5,implement:[0,8],improv:0,includ:[0,8,10],indic:10,individu:0,infer:6,init:[6,8,10],initi:8,input:[0,6,8],instal:2,install_librari:5,instruct:[0,6],inter:10,intermedi:[0,8],intermediate_s:6,intern:8,intra:10,introduc:0,introductori:0,involv:0,ipynb:[6,7,8,10],ir:6,its:[0,5,6],jax:[2,5,6,8,9,10,11],jax_platform_nam:10,jaxlib:[5,8],jaxpr:0,jaxpreqn:6,jit:[6,8],jit_train_step:8,jnp:[6,8,10],job_config:6,jupyt:[6,7,8,9,10],k1:[8,10],k2:[8,10],k:10,kernel:8,kernel_np:8,knois:[8,10],know:8,ksampl:[8,10],kwarg:6,larg:[7,8],larger:6,last:6,latenc:[0,10],later:[6,8],launch:6,lax:8,layer:10,layer_num:[6,10],layer_output:6,learn:[0,8],learning_r:[6,8,10],less:7,level:[0,6,8],lib:6,librari:[5,6],lift_mark:6,like:0,line:[6,7],linen:[6,8,10],list:0,lm:0,local:[0,6],local_devic:8,logic:6,look:0,loop:8,loss:[6,8,10],loss_func:[6,8,10],lower:[0,8],m:[0,5],machin:[0,8],made:0,mai:[6,8],mainli:2,make:2,manag:[0,10],mani:[0,10],manual:[5,6,8],manual_gpip:6,manual_layer_construct:[6,10],manual_pipeline_actual_st:10,manual_pipeline_lay:6,manual_pipeline_model:10,manual_pipeline_st:10,manual_pipeline_train_step:10,manualpipelinemlpmodel:10,map:[0,6,8],mark:[6,10],mark_pipelin:[6,10],mark_typ:[6,10],marker:[5,6,10],materi:0,mb:11,mean:[6,8,10],megatron:0,memori:[6,7,10],merg:6,mesh:[6,10],mesh_idx:6,mesh_stat:6,method:0,microbatch:10,might:0,min:0,minim:[0,10],minut:[6,7,8,10],ml:0,mlpmodel:[8,10],mode:[5,10],model:[0,6,8,10],model_util:6,modif:10,modifi:[2,5,6],modul:[6,8,10],more:[0,6,7],moreov:6,most:[6,7],move:6,ms:8,multipl:[0,10],n:0,n_all_gath:6,n_all_reduc:6,n_all_to_al:6,n_layer:6,n_reduce_scatt:6,n_total:6,name:[6,10],nccl:5,necessari:[0,10],need:[5,8,10],network:8,neural:8,new_stat:[6,8,10],next:0,nn:[6,8,10],node:0,none:6,nontrivi:8,normal:[6,8,10],note:10,notebook:[6,7,8,9,10],now:[0,10],np:8,num_attention_head:6,num_devic:6,num_head:6,num_hidden_lay:6,num_host:6,num_lay:8,num_micro_batch:10,numba:5,number:[0,6,8,10],numpi:[5,6,8,10],nvidia:0,nvlink:0,object:6,occupi:10,onc:0,one:[0,8],ones:6,onli:[5,8,10],oper:[0,7,8,10],optax:[6,8,10],optim:[0,6,8,10],orchestr:0,organ:0,origin:0,orthogon:0,other:[0,6],our:0,out:[6,8,10],output:8,output_str:6,overhead:0,own:5,p3:0,packag:[5,6],page:6,pair:0,paper:0,paralel:8,parallel:[0,9,11],parallel_execut:8,param:[6,8,10],paramet:[7,8,10],paramt:[8,10],parcip:0,part:[0,6],partial:[0,8],partit:[0,7,10],pass:10,path:5,peak:6,per:8,perform:[0,7,10],physic:6,pick:7,pip3:5,pip:2,pipelin:[0,5,6,7,8,9,11],pipeline_parallel:5,pipeline_stage_mod:[6,10],pipeshard_parallel:[6,10,11],pipeshard_stat:6,pjit:8,placement:0,plan:[0,2,6,8],platform:6,playground:2,pleas:[0,2,5],pmap:[8,9,11],pmap_lib:8,pmean:8,post:0,precis:[0,6],prefer_reduce_scatt:6,preshard_dynamic_arg:8,primit:8,print:[6,8],print_hlo_communication_stat:6,prngkei:[6,8,10],problem:8,process:[0,10],profile_all_execut:6,profile_and_pp_pipeshard_stat:6,program:0,project:5,prospector:2,provid:[6,7,8],pull:2,pulp:5,purpos:8,py:[5,6,7,8,10,11],pybind11:5,python3:[5,6],python:[2,5,6,7,8,9,10],rai:[0,5,6,10],random:[6,8,10],rang:[6,8],rational:0,read:0,readuc:6,realiz:0,recent:6,recommend:0,recompil:5,reduc:[6,8],rel:6,relat:10,relu:[8,10],remat:6,remat_lay:6,repeat:8,replac:6,repo:5,repositori:2,repres:0,represent:[0,8],request:2,requir:[0,7,8,10],research:0,reset_st:6,resid:2,restor:6,result:8,reus:10,rngkei:[6,8,10],run:[0,2,5,6,7,8,10],runtime_execut:8,s:[0,6,8],same:[6,7,8,10],scale:8,scatter:6,schedul:0,scheme:[0,8],scipi:5,script:[2,5,6,7,8,10],second:[6,7,8,10],self:[6,8,10],send:0,seper:10,seq_len:6,serial:8,serial_execut:8,servic:2,set:[0,6,10],set_parallelize_opt:10,setup:6,sever:[0,7],sh:[2,5],shape:6,shard:[0,9,11],shardeddevicearrai:8,should:6,show:[0,8,10],shown:0,shutdown:[6,10],significantli:6,similar:8,simpl:8,simplic:6,singl:[0,7],site:6,slice:[0,10],smaller:[0,6],so:[5,8],solut:6,solv:8,solver:5,some:[0,6,8],sourc:[2,6,7,8,9,10],space:6,specif:[8,10],specifi:[8,10],sphinx:[6,7,8,9,10],split:[6,8,10],spmd:2,stage:10,start:[0,5,6,9,10,11],stat:6,state:[6,8,10],std:8,step:[0,5,6,8,10],still:[6,8],store:8,str:6,strategi:[0,7,8,10],style:2,sub_logical_mesh_shap:6,sub_physical_mesh_shap:6,subgraph:0,submesh:[6,10],submesh_autosharding_option_dict:6,submit:2,sudo:5,suitabl:7,summari:7,support:[6,7,10],sync_func:8,synchronize_all_act:8,system:0,tabl:7,tailor:8,take:[0,5,8],talk:0,target:8,techniqu:[0,7,8],tensor:0,tensorflow:[2,5],term:0,termin:10,test:[1,2,5,6,8,10],test_instal:5,tf_path:5,than:[6,7],thei:[0,6,8],them:[0,6,7,8],therefor:[8,10],thi:[0,2,5,6,7,8,10],thing:8,third:[0,6],those:0,three:[0,6],time:[6,7,8,10],todo:[0,7],tofu:0,toi:10,tool:[5,7],toolkit:5,top:[0,8],total:[6,7,8,10,11],total_allocation_s:8,tqdm:5,traceback:6,train:[0,6,7,9,11],train_stat:[8,10],train_step:[6,8,10],trainstat:[6,8,10],tranform:8,transform:[7,8],tri:0,truth:[8,10],turn:6,tutori:[0,2,6,7,8,10,11],tutorials_jupyt:9,tutorials_python:9,two:[0,2,6,7,10],tx:[6,8,10],type:8,ubuntu:6,understand:0,unequalmanuallayerbertlayermodel:6,unifi:0,unit:2,unlik:[0,8],updat:[5,10],upper:0,us:[0,2,5,7,8,10],usag:[9,11],user:[0,8,10],util:[5,6,8],valu:6,variant:0,version:[0,5],via:2,view:0,w:[8,10],wai:7,want:8,warmup:8,we:[0,2,5,6,7,8,10],well:[0,6],what:0,when:[0,6],which:[0,2,7,8,10],within:10,without:[6,8],work:[7,8],worker:6,workflow:0,workload:7,wrapper:6,write:8,wx:[8,10],x:[0,6,8,10],xla:[0,2,5,8],xla_custom_call_mark:5,xla_extens:8,xmap:8,y:[6,8,10],yapf:2,ye:7,you:[0,2,5,8,10],your:[5,8],zip:9},titles:["Design and Architecture","Rationale","Developer Guide","Alpa Tutorials","Alpa documentation","Install Alpa","Advanced API Usage","Difference between alpa.parallelize and jax.pmap","Getting Started with Alpa","Alpa Tutorials","Distributed Training with Both Shard and Pipeline Parallelism","Computation times"],titleterms:{"import":[0,8,10],advanc:6,alpa:[2,3,4,5,7,8,9,10],an:[0,8,10],api:6,architectur:[0,4],auto:[6,8],automat:10,between:7,both:10,check:5,cluster:[0,6],code:2,collect:6,compar:7,comparison:8,compil:0,comput:[0,11],concept:0,construct:6,contribut:2,control:6,data:[6,7],design:0,develop:[2,4],devic:[0,8,10],differ:7,distribut:[0,10],document:4,environ:10,exampl:0,execut:8,forc:6,format:2,from:5,get:8,graph:0,guid:[2,4],initi:10,instal:[4,5],inter:[0,6],intra:0,jax:7,layer:6,librari:[8,10],lint:2,manual:10,memori:8,mesh:0,mlp:[0,8,10],model:7,op:0,oper:6,option:6,orchestratoin:0,organ:2,overview:0,parallel:[6,7,8,10],pass:0,pipelin:10,pmap:7,prefer:7,primit:6,rational:1,remateri:6,requir:5,reshard:0,runtim:0,shard:[6,10],singl:[8,10],sourc:5,specif:6,specifi:6,speed:8,stage:[0,6],start:8,strategi:6,through:0,time:11,train:[8,10],tutori:[3,4,9],us:6,usag:[6,8],walk:0,when:7,worker:0,xmap:7}})
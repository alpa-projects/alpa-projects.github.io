Search.setIndex({"docnames": ["architecture/overview", "architecture/parallelism-view-and-rationale", "developer/developer_guide", "gallery/tutorials/README", "index", "install", "tutorials/alpa_vs_pmap", "tutorials/index", "tutorials/opt_serving", "tutorials/perf_tuning_guide", "tutorials/pipeshard_parallelism", "tutorials/quickstart", "tutorials/sg_execution_times"], "filenames": ["architecture/overview.rst", "architecture/parallelism-view-and-rationale.rst", "developer/developer_guide.rst", "gallery/tutorials/README.rst", "index.rst", "install.rst", "tutorials/alpa_vs_pmap.rst", "tutorials/index.rst", "tutorials/opt_serving.rst", "tutorials/perf_tuning_guide.rst", "tutorials/pipeshard_parallelism.rst", "tutorials/quickstart.rst", "tutorials/sg_execution_times.rst"], "titles": ["Design and Architecture", "Rationale", "Developer Guide", "Alpa Tutorials", "Alpa Documentation", "Install Alpa", "Differences between alpa.parallelize and jax.pmap", "Alpa Tutorials", "Serving OPT-175B using Alpa", "Performance Tuning Guide", "Distributed Training with Both Shard and Pipeline Parallelism", "Alpa Quickstart", "Computation times"], "terms": {"thi": [0, 2, 5, 6, 8, 9, 10, 11], "document": [0, 2, 5, 8], "aim": 0, "describ": 0, "alpa": [0, 9, 10, 12], "explain": 0, "sever": [0, 6, 8, 10], "core": [0, 5], "introduc": 0, "high": [0, 11], "level": [0, 11], "organ": 0, "follow": [0, 2, 5, 8, 10], "s": [0, 2, 5, 8, 9, 10, 11], "includ": [0, 5, 9, 10, 11], "term": 0, "componen": 0, "workflow": 0, "us": [0, 2, 4, 6, 9, 10, 11], "you": [0, 2, 5, 8, 9, 10, 11], "ar": [0, 5, 6, 8, 9, 10, 11], "recommend": [0, 5], "read": [0, 8], "materi": 0, "well": 0, "research": 0, "paper": 0, "talk": 0, "slide": 0, "12": [0, 10], "min": 0, "introductori": 0, "about": [0, 5, 8], "stanford": 0, "mlsy": 0, "seminar": 0, "uw": 0, "sampl": 0, "The": [0, 2, 5, 6, 8, 9, 10, 11], "figur": [0, 8], "below": [0, 5, 6, 8], "show": [0, 8, 10, 11], "diagram": 0, "1": [0, 8, 10, 11], "like": [0, 8, 9], "mani": [0, 5, 9, 10], "exist": [0, 5, 10], "machin": [0, 11], "learn": [0, 11], "parallel": [0, 4, 7, 8, 12], "ml": 0, "two": [0, 6, 8, 10], "step": [0, 5, 8, 10, 11], "In": [0, 2, 6, 8, 9, 10, 11], "take": [0, 5, 8, 10, 11], "model": [0, 5, 9, 10, 11], "descript": 0, "form": [0, 6, 10], "input": [0, 5, 11], "perform": [0, 4, 6, 8, 10], "few": [0, 5, 9, 10], "optim": [0, 9, 10, 11], "gener": [0, 4, 6, 7, 9, 10, 11], "execut": [0, 4, 9, 10, 12], "plan": [0, 2, 4, 11], "which": [0, 6, 8, 10, 11], "custom": [0, 5], "made": 0, "binari": [0, 5], "base": [0, 5, 8, 10], "train": [0, 4, 6, 7, 8, 12], "code": [0, 5, 6, 7, 10, 11], "each": [0, 5, 8, 10], "parcip": 0, "orchestr": 0, "befor": [0, 5, 8], "we": [0, 2, 5, 6, 8, 9, 10, 11], "start": [0, 5, 8, 9, 10], "bring": 0, "unlik": [0, 11], "system": [0, 4, 5, 8], "view": [0, 10], "approach": 0, "orthogon": 0, "categori": 0, "oper": [0, 4, 6, 9, 10, 11], "thei": [0, 11], "distinguish": 0, "fact": 0, "involv": 0, "partit": [0, 6, 10], "ani": [0, 5, 11], "along": 0, "one": [0, 5, 8, 10, 11], "more": [0, 5, 6, 9, 10, 11], "tensor": [0, 9, 11], "axi": 0, "some": [0, 8, 9, 11], "fall": 0, "list": 0, "data": [0, 4, 8, 9, 10, 11], "megatron": 0, "lm": 0, "those": [0, 5, 9], "tofu": 0, "flexflow": 0, "etc": [0, 8], "placement": 0, "pipelin": [0, 4, 6, 7, 9, 11, 12], "variant": 0, "For": [0, 5, 8], "deeper": 0, "dive": 0, "what": 0, "class": [0, 10, 11], "entail": 0, "pleas": [0, 2, 5, 8], "our": [0, 5], "rational": 0, "new": [0, 2], "techniqu": [0, 6, 11], "part": [0, 8], "drive": 0, "unifi": [0, 4], "method": [0, 10], "realiz": 0, "them": [0, 5, 6, 11], "hierarchi": 0, "shown": 0, "At": 0, "upper": 0, "set": [0, 9, 11], "algorithm": [0, 10], "call": [0, 10, 11], "correspond": [0, 5, 8], "all": [0, 5, 7, 8, 10, 11], "lower": [0, 5, 9, 11], "anoth": [0, 5], "map": [0, 11], "can": [0, 4, 5, 6, 8, 9, 10, 11], "guarante": 0, "individu": 0, "local": [0, 2], "onc": 0, "run": [0, 2, 5, 6, 9, 10, 11], "third": [0, 2], "appli": [0, 10, 11], "post": 0, "process": [0, 5, 8, 10], "final": 0, "origin": [0, 5, 8, 11], "singl": [0, 4, 6, 8, 9], "node": [0, 5, 8, 9], "It": 0, "send": [0, 9], "understand": [0, 9], "necessari": [0, 10], "precis": 0, "do": [0, 5, 9, 11], "dure": 0, "repres": 0, "static": 0, "now": [0, 5, 10], "first": [0, 5, 8, 10, 11], "extract": 0, "from": [0, 8, 9, 10, 11], "user": [0, 5, 8, 9, 10, 11], "express": 0, "jaxpr": [0, 10], "intermedi": [0, 10, 11], "represent": [0, 11], "xla": [0, 2, 5, 11], "hlo": [0, 10], "manag": [0, 5, 10], "rai": [0, 5, 8], "four": 0, "aw": [0, 8], "p3": [0, 8], "16xlarg": [0, 8], "8": [0, 5, 8, 10, 11], "gpu": [0, 5, 8, 9, 11], "4x8": 0, "illustr": 0, "2": [0, 2, 8, 10, 11], "also": [0, 5, 6, 8, 9, 10, 11], "m": 0, "x": [0, 8, 10, 11], "n": 0, "slice": [0, 9, 10], "multipl": [0, 8, 10], "group": 0, "might": [0, 5], "contain": 0, "number": [0, 9, 10, 11], "commun": [0, 11], "bandwidth": 0, "nvidia": [0, 9], "nvlink": 0, "how": [0, 2, 8, 10], "4": [0, 5, 8, 10, 11], "consist": [0, 10], "partial": [0, 11], "full": [0, 6, 10, 11], "henc": [0, 8], "3": [0, 5, 8, 10, 11], "implement": [0, 11], "actor": [0, 5], "A": [0, 6, 8], "adjac": 0, "subgraph": 0, "todo": [0, 6], "With": [0, 6, 8], "abov": [0, 8, 10, 11], "exactli": 0, "smaller": [0, 8], "assign": [0, 6, 11], "scheme": [0, 11], "dynam": 0, "program": 0, "minim": [0, 10], "latenc": [0, 10], "look": [0, 5], "pair": 0, "its": [0, 8], "strategi": [0, 6, 8, 10, 11], "analyz": [0, 6], "depend": [0, 5, 9, 11], "tri": 0, "fullfil": 0, "requir": [0, 5, 6, 10, 11], "These": [0, 9], "next": [0, 5, 8, 9], "when": [0, 5], "have": [0, 5, 8, 9], "differ": [0, 4, 7, 9, 11, 12], "shard": [0, 4, 7, 8, 9, 12], "case": [0, 9], "cross": 0, "try": [0, 5, 8, 9], "between": [0, 4, 7, 12], "schedul": [0, 9], "instruct": [0, 5, 8], "overhead": 0, "three": 0, "top": [0, 11], "gspmd": 0, "despit": 0, "addition": 0, "other": [0, 5, 8], "improv": 0, "tutori": [0, 2, 6, 8, 9, 10, 11, 12], "convert": 0, "version": [0, 2, 8], "test": [1, 2, 5, 10, 11], "repositori": [2, 5], "python": [2, 6, 7, 8, 10, 11], "sourc": [2, 6, 7, 8, 10, 11], "benchmark": [2, 11], "script": [2, 5, 6, 8, 9, 10, 11], "build_jaxlib": [2, 5], "build": [2, 5, 8], "jaxlib": [2, 11], "doc": 2, "exampl": [2, 5, 6, 7, 8, 10, 11], "public": [2, 8], "playground": 2, "experiment": [2, 5], "unit": 2, "third_parti": [2, 5], "parti": 2, "repo": [2, 5, 8], "addit": [2, 5, 8, 10], "maintain": 2, "tensorflow": [2, 5], "fork": 2, "becaus": [2, 5, 8, 9, 10, 11], "modifi": [2, 5], "compil": [2, 5, 8, 10, 11], "whose": 2, "host": [2, 5], "c": [2, 5], "mainli": [2, 5], "resid": 2, "servic": [2, 8, 10], "spmd": 2, "submit": [2, 9], "pull": 2, "request": [2, 5, 8, 11], "googl": [2, 11], "style": 2, "instal": [2, 4, 8], "yapf": 2, "pylint": 2, "via": [2, 5], "pip": [2, 5], "0": [2, 5, 6, 10, 11, 12], "32": [2, 10, 12], "14": [2, 10, 11], "check": 2, "error": [2, 5, 9], "sh": [2, 8], "everi": 2, "featur": [2, 5, 6, 10, 11], "should": [2, 5, 9, 10], "come": 2, "larg": [4, 6, 8, 9, 11], "scale": [4, 11], "distribut": [4, 5, 6, 7, 8, 11, 12], "specif": [4, 8, 10, 11], "design": [4, 5, 8], "giant": 4, "neural": [4, 5, 11], "network": [4, 5, 11], "cannot": [4, 6, 8], "fit": [4, 8, 10], "devic": [4, 6, 8, 9], "automat": [4, 5, 6, 8, 9, 11], "dstirbut": 4, "quickstart": [4, 7, 12], "both": [4, 6, 7, 12], "jax": [4, 7, 8, 9, 10, 11, 12], "pmap": [4, 7, 11, 12], "tune": 4, "serv": 4, "opt": 4, "175b": 4, "page": [5, 8], "provid": [5, 6, 8, 9, 11], "minimum": 5, "support": [5, 6, 8, 10], "7": [5, 10], "regardless": 5, "packag": [5, 11], "cuda": [5, 8], "toolkit": 5, "offici": 5, "guid": [5, 8], "cudnn": 5, "11": [5, 8, 10], "5": [5, 10, 11], "ilp": 5, "solver": 5, "If": [5, 6, 8, 9, 10], "sudo": 5, "permiss": 5, "apt": 5, "coinor": 5, "cbc": 5, "otherwis": 5, "conda": 5, "updat": 5, "cupi": 5, "pip3": [5, 8], "upgrad": 5, "your": [5, 8, 9, 11], "own": 5, "here": [5, 6, 10, 11], "cuda114": 5, "mean": [5, 9, 10, 11], "Then": [5, 8, 10], "whether": 5, "alreadi": 5, "ha": [5, 11], "nccl": 5, "python3": [5, 8, 11], "import": [5, 8], "print": [5, 8, 9, 11], "noth": 5, "been": 5, "choos": 5, "9": [5, 10], "need": [5, 8, 9, 10, 11], "section": 5, "To": [5, 9, 10, 11], "make": [5, 8, 9, 10], "sure": [5, 8, 9], "want": [5, 10, 11], "specifi": [5, 8, 10, 11], "particular": 5, "explicitli": [5, 11], "cuda_vers": 5, "cudnn_vers": 5, "f": [5, 11], "http": [5, 8, 10, 11], "project": 5, "github": [5, 11], "io": 5, "html": 5, "compat": 5, "command": [5, 9, 10], "cuda111": 5, "cudnn805": 5, "see": [5, 8, 9, 11], "avail": [5, 8, 10, 11], "pypi": 5, "index": [5, 8, 9], "As": [5, 8], "regularli": 5, "rebas": 5, "catch": 5, "up": 5, "upstream": 5, "newer": 5, "open": [5, 8], "an": [5, 6, 8, 9], "issu": [5, 8, 9], "clone": [5, 8], "git": 5, "recurs": 5, "com": [5, 11], "cd": [5, 8], "e": [5, 8, 10], "dev": 5, "note": [5, 8, 9, 10], "suffix": 5, "modul": [5, 10, 11], "py": [5, 6, 8, 10, 11, 12], "enable_cuda": 5, "dev_instal": 5, "tf_path": 5, "pwd": 5, "dist": 5, "develop": [5, 8], "mode": [5, 8], "so": [5, 9, 10, 11], "effect": 5, "immedi": 5, "onli": [5, 11], "recompil": 5, "head": [5, 8], "test_instal": 5, "while": [5, 11], "meet": 5, "No": 5, "control": [5, 9, 10], "flow": 5, "weight": 5, "share": 5, "enabl": [5, 9, 10, 11], "nightli": 5, "torch": [5, 8], "torchdistx": 5, "uninstal": 5, "y": [5, 10, 11], "pre": [5, 8], "extra": [5, 8], "url": [5, 8], "download": [5, 6, 7, 10, 11], "org": [5, 8], "whl": [5, 8], "cpu": [5, 9, 10], "functorch": 5, "setup": [5, 8], "torch_frontend": 5, "test_simpl": 5, "usag": [5, 8, 9], "sinc": 5, "reli": [5, 9], "cluster": [5, 8, 9, 11], "long": 5, "troubl": [5, 8], "simpl": [5, 9, 11], "without": [5, 8, 11], "move": [5, 9], "forward": [5, 10], "same": [5, 6, 10, 11], "environ": [5, 8, 11], "common": [5, 6], "proxi": 5, "client": 5, "connect": [5, 8], "time": [5, 6, 10, 11], "out": [5, 8, 10, 11], "found": 5, "thread": 5, "fix": [5, 9], "spawn": 5, "launch": [5, 9], "job": 5, "srun": 5, "enough": 5, "resourc": [5, 8], "adjust": 5, "valu": [5, 9], "argument": [5, 9, 11], "per": [5, 11], "task": 5, "pass": [5, 9, 10], "inform": 5, "find": [5, 11], "discuss": 5, "under": [5, 8], "452": 5, "help": 5, "self": [5, 10, 11], "howev": [5, 6, 9, 11], "sometim": 5, "librari": 5, "optax": [5, 10, 11], "incompat": 5, "appear": 5, "runtimeerror": 5, "than": [5, 6], "reinstal": 5, "either": [5, 8], "prebuilt": 5, "clean": 5, "virtual": 5, "procedur": [5, 8], "strictli": 5, "due": [5, 8], "silent": 5, "similar": [5, 11], "after": [5, 11], "against": 5, "api": [5, 11], "0xf": 5, "0xd": 5, "importerror": 5, "_multiarray_umath": 5, "fail": [5, 9], "umath": 5, "2022": [5, 10], "05": [5, 10], "20": [5, 10], "21": [5, 10], "57": [5, 10], "35": [5, 10], "710782": 5, "extern": 5, "org_tensorflow": 5, "cc": 5, "83": [5, 10], "registernumpybfloat16": 5, "abort": 5, "dump": 5, "higher": 5, "later": [5, 11], "address": [5, 8, 10], "downgrad": 5, "rebuild": 5, "switch": 5, "back": 5, "applic": 5, "thank": 5, "backward": [5, 10], "461": 5, "click": [6, 10, 11], "most": 6, "tool": 6, "comput": [6, 9, 10, 11], "line": 6, "chang": 6, "billion": 6, "paramet": [6, 10, 11], "On": 6, "contrari": 6, "wai": [6, 8], "graph": [6, 9, 10, 11], "pick": [6, 8], "best": [6, 8, 9, 11], "suitabl": 6, "achiev": 6, "less": 6, "better": 6, "memori": [6, 8, 9], "go": 6, "workload": 6, "detail": [6, 8], "comparison": 6, "among": 6, "attach": 6, "end": 6, "articl": 6, "besid": 6, "advanc": [6, 9, 10, 11], "tabl": 6, "summari": 6, "transform": [6, 8, 11], "autom": [6, 10], "ye": 6, "work": [6, 8, 9, 11], "total": [6, 8, 10, 11, 12], "minut": [6, 10, 11], "001": [6, 12], "second": [6, 10, 11], "alpa_vs_pmap": [6, 12], "jupyt": [6, 7, 10, 11], "notebook": [6, 7, 10, 11], "ipynb": [6, 10, 11], "galleri": [6, 7, 10, 11], "sphinx": [6, 7, 10, 11], "tutorials_python": 7, "zip": 7, "tutorials_jupyt": 7, "largest": 8, "pretrain": 8, "languag": 8, "render": 8, "offer": 8, "uniqu": 8, "advantag": 8, "Not": 8, "problem": [8, 10, 11], "big": [8, 9], "gpt": 8, "commod": 8, "hardwar": 8, "hous": 8, "latest": 8, "a100": 8, "80gb": 8, "nor": 8, "fanci": 8, "infiniband": 8, "constraint": 8, "flexibl": [8, 10], "appropri": 8, "architectur": [8, 9], "size": [8, 9], "rang": [8, 11], "125m": 8, "backend": 8, "effici": [8, 10, 11], "infer": 8, "frontend": 8, "collect": 8, "batch": [8, 9, 10, 11], "obtain": 8, "metaseq": 8, "subject": 8, "least": 8, "350gb": 8, "entir": 8, "instanc": 8, "16": [8, 10], "gb": [8, 11], "512": 8, "66b": 8, "30b": 8, "huggingfac": 8, "interfac": 8, "autotoken": 8, "opt_serv": 8, "wrapper": 8, "get_model": 8, "load": 8, "token": 8, "from_pretrain": 8, "facebook": 8, "use_fast": 8, "fals": 8, "add_bos_token": 8, "model_nam": 8, "7b": 8, "path": 8, "home": 8, "ubuntu": 8, "opt_weight": 8, "prompt": 8, "pari": 8, "capit": 8, "citi": 8, "input_id": 8, "return_tensor": 8, "pt": 8, "output": [8, 11], "max_length": 8, "256": 8, "do_sampl": 8, "true": 8, "generated_str": 8, "batch_decod": 8, "skip_special_token": 8, "wheel": 8, "alwai": 8, "fetch": [8, 9], "flask": 8, "cython": 8, "omegaconf": 8, "g": 8, "torchvis": 8, "torchaudio": 8, "pytorch": 8, "cu113": 8, "file": [8, 12], "faster": [8, 11], "bash": 8, "There": 8, "copi": [8, 10, 11], "team": 8, "skip": 8, "latter": 8, "hour": 8, "verifi": 8, "992": 8, "md5": 8, "put": 8, "folder": 8, "sai": 8, "path_to_992_shard": 8, "consolid": 8, "checkpoint": 8, "step_2_consolidate_992_shards_to_singleton": 8, "prefix": 8, "checkpoint_last": 8, "save": [8, 10], "path_to_save_checkpoint": 8, "peak": [8, 10], "ram": 8, "twice": 8, "approxim": 8, "byte": 8, "700gb": 8, "suffici": 8, "throw": 8, "oom": 8, "except": 8, "disk": 8, "space": 8, "target": [8, 11], "350m": 8, "3b": 8, "6": [8, 10], "13b": 8, "singleton": 8, "link": 8, "proce": 8, "ingest": 8, "simpli": 8, "numpi": [8, 10, 11], "step_3_convert_to_numpy_weight": 8, "ckpt_path": 8, "output_path": 8, "free": 8, "write": [8, 11], "altern": [8, 10], "preprocess": 8, "meta": 8, "abl": 8, "convers": 8, "join": 8, "slack": 8, "add": 8, "root": 8, "directori": 8, "variabl": [8, 11], "pythonpath": 8, "benchmark_text_gen": 8, "debug": [8, 9], "text": 8, "path_to_weight": 8, "successfulli": 8, "rememb": 8, "port": 8, "10001": 8, "interactive_host": 8, "ip": 8, "browser": 8, "dataset": [8, 10], "loader": 8, "entri": 8, "point": 8, "tip": 9, "analys": [9, 11], "primit": [9, 10, 11], "auto": [9, 10], "tricki": 9, "complic": 9, "especi": 9, "concaten": 9, "correctli": 9, "gradual": 9, "ones": 9, "basic": 9, "dataparallel": 9, "small": 9, "configur": [9, 11], "func": 9, "warn": [9, 10], "detect": 9, "unexpect": 9, "behavior": 9, "reproduc": 9, "report": 9, "zero2parallel": 9, "expect": 9, "alloc": 9, "element": 9, "wise": 9, "state": [9, 10, 11], "adam": [9, 10, 11], "smi": 9, "doe": [9, 11], "get_total_allocation_s": [9, 11], "did": 9, "quick": [9, 10], "shardparallel": 9, "logic": 9, "mesh": [9, 10], "shape": 9, "gradient": [9, 10], "accumul": [9, 10], "replac": 9, "grad": [9, 10, 11], "value_and_grad": 9, "respect": 9, "larger": 9, "global": [9, 11], "increas": 9, "num_micro_batch": [9, 10], "accordingli": 9, "pipeshardparallel": [9, 10], "combin": [9, 10, 11], "layer": [9, 10], "construct": [9, 10], "layer_opt": [9, 10], "autolayeropt": [9, 10], "layer_num": [9, 10], "choic": 9, "repetit": 9, "block": 9, "manual": [9, 11], "mark_pipeline_boundari": [9, 10], "micro": [9, 10], "affect": 9, "lot": 9, "driver": [9, 10], "worker": [9, 10], "just": 9, "think": 9, "easier": 9, "potenti": 9, "lead": 9, "signific": 9, "avoid": 9, "frequent": 9, "synchron": 9, "overlap": 9, "access": 9, "distributedarrai": 9, "metadata": 9, "dtype": [9, 11], "store": [9, 11], "function": [10, 11], "k": 10, "intra": 10, "inter": 10, "focus": 10, "stage": 10, "assert_allclos": [10, 11], "flax": [10, 11], "linen": [10, 11], "nn": [10, 11], "train_stat": [10, 11], "trainstat": [10, 11], "jnp": [10, 11], "random": [10, 11], "framework": [10, 11], "disribut": 10, "init": [10, 11], "07": 10, "02": [10, 12], "09": 10, "833": 10, "info": 10, "1470": 10, "dashboard": 10, "127": 10, "8265": 10, "toi": 10, "wx": [10, 11], "b": [10, 11], "being": [10, 11], "forc": 10, "mlpmodel": [10, 11], "hidden_dim": [10, 11], "int": [10, 11], "compact": [10, 11], "def": [10, 11], "__call__": [10, 11], "dens": [10, 11], "relu": [10, 11], "return": [10, 11], "dim": [10, 11], "2048": [10, 11], "batch_siz": [10, 11], "ground": [10, 11], "truth": [10, 11], "w": [10, 11], "rngkei": [10, 11], "prngkei": [10, 11], "k1": [10, 11], "k2": [10, 11], "split": [10, 11], "normal": [10, 11], "float32": [10, 11], "ksampl": [10, 11], "knois": [10, 11], "paramt": [10, 11], "param": [10, 11], "tx": [10, 11], "learning_r": [10, 11], "1e": [10, 11], "creat": [10, 11], "apply_fn": [10, 11], "defin": [10, 11], "train_step": [10, 11], "loss_func": [10, 11], "loss": [10, 11], "new_stat": [10, 11], "apply_gradi": [10, 11], "expected_st": [10, 11], "paral": 10, "mark": 10, "boundari": 10, "manualpipelinemlpmodel": 10, "marker": 10, "separ": 10, "manual_pipeline_model": 10, "manual_pipeline_st": 10, "deepcopi": 10, "option": [10, 11], "let": 10, "fill": 10, "manual_pipeline_train_step": 10, "seper": 10, "ensur": 10, "correct": [10, 11], "manual_pipeline_actual_st": 10, "atol": [10, 11], "5e": [10, 11], "shutdown": 10, "equal": 10, "stage_opt": 10, "manualstageopt": 10, "i": [10, 11], "hyperparamet": 10, "submesh": 10, "construcion": 10, "bodi": [10, 11], "auto_pipeline_train_step": 10, "again": 10, "trigger": 10, "profil": 10, "cost": [10, 11], "solv": [10, 11], "get": [10, 11], "auto_pipeline_actual_st": 10, "pipeline_parallel": 10, "layer_construct": 10, "too": 10, "non": 10, "trivial": 10, "op": 10, "dot": 10, "conv": 10, "mai": [10, 11], "influenc": 10, "submesh_choic": 10, "00": [10, 12], "100": 10, "29": 10, "54it": 10, "03": [10, 12], "60": 10, "01": 10, "22it": 10, "72it": 10, "30it": 10, "008": 10, "max_n_succ_stag": 10, "4096": 10, "mem": 10, "10": [10, 11], "457gb": 10, "001gb": 10, "000gb": 10, "500gb": 10, "as_config": 10, "force_batch_dim_to_mesh_dim": 10, "26": 10, "55": [10, 11, 12], "004": 10, "501gb": 10, "250gb": 10, "23": [10, 11], "40": 10, "82": 10, "251gb": 10, "125gb": 10, "24": 10, "92": 10, "098gb": 10, "063gb": 10, "25": 10, "80": 10, "85": 10, "005": 10, "08": 10, "71": 10, "inf": 10, "00766142": 10, "00427175": 10, "00359819": 10, "00435511": 10, "00483327": 10, "15": 10, "75it": 10, "50": [10, 11], "80it": 10, "62it": 10, "96": 10, "33": 10, "04": 10, "70it": 10, "58": 10, "42it": 10, "19it": 10, "25it": 10, "97it": 10, "002": 10, "252gb": 10, "42": 10, "099gb": 10, "17": 10, "31": 10, "18": 10, "2649": 10, "004gb": 10, "007": 10, "2933": 10, "003gb": 10, "006": 10, "2075": 10, "194gb": 10, "005gb": 10, "06": 10, "67": 10, "03it": 10, "002gb": 10, "19": 10, "75": 10, "27it": 10, "003": 10, "98it": 10, "45it": 10, "63": 10, "00360494": 10, "00241113": 10, "00190377": 10, "00189781": 10, "0068211": 10, "00500711": 10, "00441935": 10, "0059317": 10, "00379237": 10, "00415519": 10, "00270171": 10, "00274571": 10, "66it": 10, "76it": 10, "90it": 10, "90": 10, "44": 10, "78": [10, 11], "37it": 10, "65it": 10, "74it": 10, "3774": 10, "61": 10, "22": 10, "1340": 10, "383gb": 10, "007gb": 10, "81": 10, "3785": 10, "502gb": 10, "56": 10, "30": 10, "2767": 10, "13": 10, "1466": 10, "006gb": 10, "26it": 10, "89": 10, "3179": 10, "86it": 10, "00384182": 10, "00220142": 10, "00218402": 10, "0071928": 10, "00501919": 10, "00461939": 10, "00401531": 10, "00273085": 10, "00271482": 10, "01it": 10, "40it": 10, "15it": 10, "752": 10, "763gb": 10, "012gb": 10, "53": 10, "1914": 10, "384gb": 10, "48": 10, "1608": 10, "99": 10, "34": 10, "36": 10, "00313467": 10, "00343593": 10, "00669209": 10, "00659143": 10, "00366039": 10, "003594": 10, "npy": 10, "result": [10, 11], "forward_stage_layer_id": 10, "mesh_shap": 10, "logical_mesh_shap": 10, "autosharding_option_dict": 10, "673": [10, 12], "pipeshard_parallel": [10, 12], "built": 11, "tailor": 11, "art": 11, "therefor": 11, "expertis": 11, "although": 11, "intern": 11, "functool": 11, "np": 11, "begin": 11, "loop": 11, "num_lay": 11, "els": 11, "initi": 11, "env": 11, "lib": 11, "site": 11, "_src": 11, "lax_numpi": 11, "1866": 11, "userwarn": 11, "float64": 11, "asarrai": 11, "truncat": 11, "jax_enable_x64": 11, "shell": 11, "current": 11, "gotcha": 11, "lax_intern": 11, "_check_user_dtype_support": 11, "jit": 11, "know": 11, "pjit": 11, "xmap": 11, "fulli": 11, "ax": 11, "lax": 11, "pmean": 11, "all_gath": 11, "nontrivi": 11, "thing": 11, "given": 11, "tranform": 11, "decor": 11, "paralel": 11, "alpa_train_step": 11, "actual_st": 11, "still": 11, "arrai": 11, "accord": 11, "distributedli": 11, "type": 11, "dense_0": 11, "kernel": 11, "kernel_np": 11, "xla_extens": 11, "devicearrai": 11, "pmap_lib": 11, "shardeddevicearrai": 11, "By": 11, "acceler": 11, "reduc": 11, "donat": 11, "freed": 11, "util": 11, "benchmark_func": 11, "serial": 11, "jit_train_step": 11, "donate_argnum": 11, "sync_func": 11, "local_devic": 11, "synchronize_all_act": 11, "serial_execut": 11, "warmup": 11, "repeat": 11, "1e3": 11, "2f": 11, "ms": 11, "std": 11, "purpos": 11, "preshard_dynamic_arg": 11, "parallel_execut": 11, "206": 11, "94": 11, "86": 11, "164": 11, "compar": 11, "1024": 11, "runtime_execut": 11, "total_allocation_s": 11, "get_execut": 11, "318": [11, 12], "27": 12, "991": 12, "mb": 12}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"design": 0, "architectur": [0, 4], "overview": [0, 8], "compil": 0, "import": [0, 10, 11], "concept": 0, "comput": [0, 12], "graph": 0, "devic": [0, 10, 11], "cluster": [0, 10], "mesh": 0, "worker": 0, "stage": 0, "reshard": 0, "pass": 0, "inter": 0, "op": 0, "intra": 0, "runtim": [0, 9], "orchestratoin": 0, "walk": 0, "through": 0, "exampl": 0, "distribut": [0, 10], "an": [0, 10, 11], "mlp": [0, 10, 11], "rational": 1, "develop": [2, 4], "guid": [2, 4, 9], "code": [2, 8], "organ": 2, "contribut": 2, "alpa": [2, 3, 4, 5, 6, 7, 8, 11], "format": [2, 8], "lint": 2, "unittest": 2, "tutori": [3, 4, 7], "document": 4, "get": [4, 8], "start": 4, "instal": 5, "prerequisit": 5, "method": [5, 9], "1": 5, "from": 5, "python": 5, "wheel": 5, "2": 5, "sourc": 5, "check": 5, "option": 5, "pytorch": 5, "frontend": 5, "troubleshoot": 5, "us": [5, 8], "slurm": 5, "jaxlib": 5, "jax": [5, 6], "flax": 5, "version": 5, "problem": 5, "numpi": 5, "differ": 6, "between": 6, "parallel": [6, 9, 10, 11], "pmap": 6, "when": 6, "data": 6, "prefer": 6, "model": [6, 8], "compar": 6, "xmap": 6, "pjit": 6, "serv": 8, "opt": 8, "175b": 8, "demo": 8, "requir": 8, "compat": 8, "weight": 8, "convert": 8, "yourself": 8, "download": 8, "run": 8, "benchmark": 8, "gener": 8, "command": 8, "line": 8, "launch": 8, "web": 8, "server": 8, "structur": 8, "licens": 8, "perform": 9, "tune": 9, "choos": 9, "reduc": 9, "overhead": 9, "train": [10, 11], "both": 10, "shard": 10, "pipelin": 10, "librari": [10, 11], "initi": 10, "environ": 10, "connect": 10, "rai": 10, "singl": [10, 11], "manual": 10, "assign": 10, "automat": 10, "quickstart": 11, "auto": 11, "execut": 11, "speed": 11, "comparison": 11, "memori": 11, "usag": 11, "time": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})
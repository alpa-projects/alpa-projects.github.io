Search.setIndex({docnames:["architecture/overview","architecture/parallelism-view-and-rationale","developer/developer_guide","gallery/tutorials/README","index","install","tutorials/alpa_vs_pmap","tutorials/index","tutorials/perf_tuning_guide","tutorials/pipeshard_parallelism","tutorials/quickstart","tutorials/sg_execution_times"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["architecture/overview.rst","architecture/parallelism-view-and-rationale.rst","developer/developer_guide.rst","gallery/tutorials/README.rst","index.rst","install.rst","tutorials/alpa_vs_pmap.rst","tutorials/index.rst","tutorials/perf_tuning_guide.rst","tutorials/pipeshard_parallelism.rst","tutorials/quickstart.rst","tutorials/sg_execution_times.rst"],objects:{},objnames:{},objtypes:{},terms:{"0":[2,5,6,9,10,11],"00":[9,11],"000gb":9,"001":[6,9,11],"00103945":9,"00104411":9,"00121297":9,"0014992":9,"00153573":9,"00160077":9,"00161812":9,"00163656":9,"00178419":9,"00180128":9,"00182258":9,"00191789":9,"001gb":9,"002":9,"00200306":9,"00210998":9,"00224797":9,"002253":9,"00234103":9,"00238363":9,"00251436":9,"00260342":9,"00265569":9,"00270878":9,"00276081":9,"00280817":9,"00296113":9,"002gb":9,"003":9,"00300699":9,"00306161":9,"003gb":9,"004":9,"00438248":9,"00444471":9,"00477113":9,"00487892":9,"004gb":9,"005":9,"00507098":9,"005gb":9,"006gb":9,"007gb":9,"01":9,"012gb":9,"01it":9,"02":[9,11],"020":9,"03":[9,11],"04":9,"04it":9,"05":5,"05it":9,"06":9,"063gb":9,"06it":9,"07":9,"08":9,"098gb":9,"099gb":9,"09it":9,"0xd":5,"0xf":5,"1":[0,5,9,10],"10":[9,10,11],"100":9,"1014":9,"1024":10,"11":[5,9],"12":[0,9],"123":5,"125gb":9,"127":[9,11],"13":9,"1333":9,"14":[2,9],"15":9,"152":10,"16":9,"169":5,"16xlarg":0,"17":9,"1778":9,"18":9,"1866":10,"19":9,"194gb":9,"1991":9,"1e":[9,10],"1e3":10,"2":[0,2,5,9,10],"20":[5,9],"2022":[5,9],"2048":[9,10],"21":[5,9],"2134":9,"22":[9,10],"229":5,"24":[9,11],"25":9,"250gb":9,"251gb":9,"252gb":9,"2540":9,"26it":9,"2732":9,"28":9,"28it":9,"29":9,"2f":10,"3":[0,5,9,10],"30":9,"31":9,"32":[2,9],"33":9,"34":9,"35":5,"3525":9,"35it":9,"3643":9,"383gb":9,"384gb":9,"391":[10,11],"3984":9,"4":[0,5,9,10],"40":9,"4096":9,"41":9,"42":9,"44":9,"45":[9,10,11],"452":5,"46":9,"461":5,"46it":9,"48":5,"4x8":0,"5":[5,9,10],"50":[9,10],"500gb":9,"501gb":9,"502gb":9,"53":9,"53it":9,"54":9,"55it":9,"56":9,"57":[5,9],"58":9,"59it":9,"5e":[9,10],"6":9,"60":9,"61it":9,"62":10,"62it":9,"64it":9,"664gb":9,"67":9,"68it":9,"69":9,"7":[5,9,10],"71":9,"710782":5,"735":[9,11],"75":[9,10],"75it":9,"76":9,"763gb":9,"78":[9,10],"79it":9,"8":[0,5,9,10],"80":9,"8080":5,"82":9,"8266":9,"83":[5,9],"83it":9,"84":9,"84it":9,"89":[9,10],"9":[5,9],"91it":9,"92":9,"93":10,"93it":9,"97":9,"97it":9,"case":[0,8,9],"catch":5,"class":[0,9,10],"do":[0,5,8,10],"final":0,"function":[9,10],"import":5,"int":[9,10],"long":5,"new":[0,2],"public":2,"return":[9,10],"static":0,"switch":5,"try":[0,5,8],"while":[5,10],A:[0,6],As:5,At:0,By:10,For:[0,5],If:[5,6,8],In:[0,2,6,8,9,10],It:0,No:5,On:6,The:[0,2,5,6,8,9,10],Then:[5,9],These:[0,8],To:[5,8,9,10],With:[0,6],__call__:[9,10],_check_user_dtype_support:10,_multiarray_umath:5,_src:10,abort:5,about:[0,5],abov:[0,10],acceler:10,access:8,accord:10,accordingli:8,accumul:[8,9],achiev:6,actor:[0,5],actual_st:10,adam:[8,9,10],addit:[2,5],addition:0,address:[5,9],adjac:0,adjust:5,advanc:[6,8,10],affect:8,after:[5,10],again:9,against:5,aim:0,algorithm:[0,9],all:[0,5,7,9,10],all_gath:10,alloc:8,along:0,alpa:[0,8,9,11],alpa_train_step:10,alpa_vs_pmap:[6,11],alreadi:5,also:[0,5,6,8,9,10],altern:9,although:10,among:6,an:[5,6,8],analys:[8,10],analyz:[0,6],ani:[0,5,10],anoth:[0,5],api:[5,10],appear:5,appli:[0,9,10],applic:5,apply_fn:[9,10],apply_gradi:[9,10],approach:0,apt:5,ar:[0,5,6,8,9,10],architectur:8,argument:[5,8,10],arrai:10,art:10,articl:6,as_config:9,asarrai:10,assert_allclos:[9,10],assign:[0,6,10],atol:[9,10],attach:6,auto:[8,9],auto_pipeline_actual_st:9,auto_pipeline_train_step:9,autom:[6,9],automat:[4,5,6,8,10],automatic_layer_construct:[8,9],autosharding_option_dict:9,avail:[5,9,10],avoid:8,aw:0,ax:10,axi:0,b:[9,10],back:5,backward:[5,9],bandwidth:0,base:[0,5,9],basic:8,batch:[8,9,10],batch_siz:[9,10],becaus:[2,5,8,9,10],been:5,befor:[0,5],begin:10,behavior:8,being:[9,10],below:[0,5,6],benchmark:[2,10],benchmark_func:10,besid:6,best:[6,8,10],better:6,between:[0,4,7,11],big:8,billion:6,binari:[0,5],block:8,bodi:10,both:[4,6,7,11],boundari:9,bring:0,build:[2,5],build_jaxlib:[2,5],built:10,c:[2,5],call:[0,9,10],can:[0,4,5,6,8,9,10],cannot:[4,6],categori:0,cbc:5,cc:5,cd:5,chang:6,check:2,choic:8,clean:5,click:[6,9,10],client:5,clone:5,cluster:[5,8,10],code:[0,5,6,7,9,10],coinor:5,com:[5,10],combin:[8,9,10],come:2,command:[5,8,9],common:[5,6],commun:[0,10],compact:[9,10],compar:10,comparison:6,compat:5,compil:[2,5,9,10],complic:8,componen:0,comput:[6,8,9,10],concaten:8,conda:5,configur:[8,10],connect:5,consist:[0,9],construct:[8,9],contain:0,contrari:6,control:[5,8,9],conv:9,convert:0,copi:[9,10],core:[0,5],correct:[9,10],correctli:8,correspond:[0,5],cost:[9,10],cpu:[5,8,9],creat:[9,10],cross:0,cuda111:5,cuda114:5,cuda:5,cuda_vers:5,cudnn805:5,cudnn:5,cudnn_vers:5,cupi:5,current:10,custom:[0,5],dashboard:9,data:[0,4,8,9,10],dataparallel:8,dataset:9,debug:8,decor:[9,10],deepcopi:9,deeper:0,def:[9,10],defin:[9,10],dens:[9,10],dense_0:10,depend:[0,5,8,10],describ:0,descript:0,design:[4,5],despit:0,detail:6,detect:8,dev:5,dev_instal:5,develop:5,devic:[4,6,8],devicearrai:10,diagram:0,did:8,differ:[0,4,7,8,10,11],dim:[9,10],discuss:5,disribut:9,dist:5,distinguish:0,distribut:[4,5,6,7,10,11],distributedarrai:8,distributedli:10,dive:0,doc:2,document:[0,2,5],doe:[8,10],donat:10,donate_argnum:10,dot:9,downgrad:5,download:[5,6,7,9,10],drive:0,driver:[8,9],dstirbut:4,dtype:[8,10],due:5,dump:5,dure:0,dynam:0,e:[5,9],each:[0,5,9],easier:8,effect:5,effici:10,either:5,element:8,els:10,enabl:[5,8,10],enable_cuda:5,end:6,enough:5,ensur:9,entail:0,environ:[5,10],error:[2,5,8],especi:8,etc:0,everi:2,exactli:0,exampl:[2,5,6,7,9,10],execut:[0,4,8,9,11],exist:[0,5,9],expect:8,expected_st:[9,10],experiment:2,expertis:10,explain:0,explicitli:[5,10],express:0,extern:5,extra:5,extract:0,f:[5,10],fact:0,fail:[5,8],fall:0,faster:10,featur:[2,5,6,9,10],fetch:8,few:[0,5,8,9],figur:0,file:11,find:[5,10],first:[0,5,9,10],fit:[4,9],fix:[5,8],flax:[9,10],flexflow:0,float32:[9,10],float64:10,flow:5,focus:9,follow:[0,2,5,9],forc:9,force_batch_dim_to_mesh_dim:9,fork:2,form:[0,6,9],forward:[5,9],forward_stage_layer_id:9,found:5,four:0,framework:[9,10],freed:10,frequent:8,from:[0,8,9,10],full:[0,6,9,10],fullfil:0,fulli:10,func:8,functool:10,functorch:5,galleri:[6,7,9,10],gb:10,gener:[0,4,6,7,8,9,10],get:[9,10],get_execut:10,get_total_allocation_s:[8,10],giant:4,git:5,github:[5,10],given:10,global:[8,10],go:6,googl:[2,10],gotcha:10,gpu:[0,5,8,10],grad:[8,9,10],gradient:[8,9],gradual:8,graph:[6,8,9,10],ground:[9,10],group:0,gspmd:0,guarante:0,guid:5,ha:[5,10],have:[0,5,8],head:5,help:5,henc:0,here:[5,6,9,10],hidden_dim:[9,10],hierarchi:0,high:[0,10],higher:5,hlo:[0,9],home:10,host:[2,5],how:[0,2,9],howev:[5,6,8,10],http:[5,9,10],hyperparamet:9,i:[5,9,10],illustr:0,ilp:5,immedi:5,implement:[0,10],importerror:5,improv:0,includ:[0,5,8,9,10],incompat:5,increas:8,index:[5,8],indic:9,individu:0,inf:9,influenc:9,info:9,inform:5,init:[9,10],initi:10,input:[0,5,10],instal:[2,4],instruct:[0,5],inter:9,intermedi:[0,9,10],intern:10,intra:9,introduc:0,introductori:0,involv:0,ipynb:[6,9,10],issu:[5,8],its:0,jax:[4,7,8,9,10,11],jax_enable_x64:10,jaxlib:[2,10],jaxpr:[0,9],jit:10,jit_train_step:10,jnp:[9,10],job:5,jupyt:[6,7,9,10],just:8,k1:[9,10],k2:[9,10],k:9,kernel:10,kernel_np:10,knois:[9,10],know:10,ksampl:[9,10],larg:[4,6,8,10],larger:8,latenc:[0,9],later:[5,10],launch:[5,8],lax:10,lax_intern:10,lax_numpi:10,layer:[8,9],layer_construct:9,layer_num:[8,9],lead:8,learn:[0,10],learning_r:[9,10],less:6,let:9,level:[0,10],lib:10,librari:5,like:[0,8],line:6,linen:[9,10],list:0,lm:0,local:[0,2,10],local_devic:10,logic:8,logical_mesh_shap:9,look:[0,5],loop:10,loss:[9,10],loss_func:[9,10],lot:8,lower:[0,5,8,10],m:0,machin:[0,10],made:0,mai:[9,10],mainli:[2,5],maintain:2,make:[5,8],manag:[0,5,9],mani:[0,5,8,9],manual:[8,10],manual_layer_construct:[8,9],manual_pipeline_actual_st:9,manual_pipeline_model:9,manual_pipeline_st:9,manual_pipeline_train_step:9,manualpipelinemlpmodel:9,map:[0,10],mark:9,mark_pipeline_boundari:[8,9],marker:9,materi:0,max_n_succ_stag:9,mb:11,mean:[5,8,9,10],meet:5,megatron:0,mem:9,memori:[6,8],mesh:[8,9],mesh_shap:9,metadata:8,method:[0,9],micro:8,might:[0,5],min:0,minim:[0,9],minut:[6,9,10],ml:0,mlpmodel:[9,10],mlsy:0,mode:5,model:[0,5,8,9,10],modif:9,modifi:[2,5],modul:[5,9,10],more:[0,5,6,8,10],most:6,move:[5,8],ms:10,multipl:[0,9],n:0,nccl:5,necessari:[0,9],need:[5,8,9,10],network:[4,5,9,10],neural:[4,5,10],new_stat:[9,10],newer:5,next:[0,5,8],nightli:5,nn:[9,10],node:[0,5,8],non:9,nontrivi:10,normal:[9,10],note:[5,8,9],notebook:[6,7,9,10],noth:5,now:[0,5,9],np:10,npy:9,num_lay:10,num_micro_batch:[8,9],number:[0,8,9,10],numpi:[9,10],nvidia:[0,8],nvlink:0,offici:5,onc:0,one:[0,5,10],ones:8,onli:[5,9,10],op:9,open:5,oper:[0,4,6,8,9,10],optax:[5,9,10],optim:[0,8,9,10],option:[5,9,10],orchestr:0,org:5,org_tensorflow:5,organ:0,origin:[0,5,10],orthogon:0,other:[0,5],otherwis:5,our:[0,5],out:[5,9,10],output:10,overhead:0,overlap:8,own:5,p3:0,packag:[5,10],page:5,pair:0,paper:0,paralel:10,parallel:[0,4,7,11],parallel_execut:10,param:[9,10],paramet:[6,9,10],paramt:[9,10],parcip:0,part:0,parti:2,partial:[0,10],particular:5,partit:[0,6,9],pass:[5,8,9],peak:9,per:[5,10],perform:[0,4,6,9],permiss:5,pick:6,pip3:5,pip:[2,5],pipelin:[0,4,6,7,8,10,11],pipeline_parallel:9,pipeshard_parallel:[9,11],pipeshardparallel:[8,9],pjit:10,placement:0,plan:[0,2,4,10],playground:2,pleas:[0,2,5],pmap:[4,7,10,11],pmap_lib:10,pmean:10,post:0,potenti:8,pre:5,prebuilt:5,precis:0,preshard_dynamic_arg:10,primit:[8,10],print:[5,8,10],prngkei:[9,10],problem:[9,10],procedur:5,process:[0,5,9],profil:9,program:0,project:5,provid:[5,6,8,10],proxi:5,pull:2,purpos:10,pwd:5,py:[5,6,9,10,11],pylint:2,pypi:5,python3:[5,10],python:[2,6,7,9,10],quick:[8,9],quickstart:[4,7,11],rai:[0,5],random:[9,10],rang:10,rational:0,read:0,realiz:0,rebas:5,rebuild:5,recommend:[0,5],recompil:5,recurs:5,reduc:10,regardless:5,registernumpybfloat16:5,regularli:5,reinstal:5,reli:[5,8],relu:[9,10],repeat:10,repetit:8,replac:8,repo:[2,5],report:8,repositori:[2,5],repres:0,represent:[0,10],reproduc:8,request:[2,5,10],requir:[0,6,9,10],research:0,resid:2,resourc:5,respect:8,result:[9,10],reus:9,rngkei:[9,10],run:[0,2,5,6,8,9,10],runtime_execut:10,runtimeerror:5,s:[0,2,5,8,9,10],same:[5,6,9,10],sampl:0,save:9,scale:[4,10],schedul:[0,8],scheme:[0,10],script:[2,5,6,8,9,10],second:[6,9,10],section:5,see:[5,8,10],self:[5,9,10],seminar:0,send:[0,8],separ:9,seper:9,serial:10,serial_execut:10,server:5,servic:[2,9],set:[0,8,10],setup:5,sever:[0,6,9],sh:2,shape:8,shard:[0,4,7,8,11],shardeddevicearrai:10,shardparallel:8,share:5,shell:10,should:[2,5,8],show:[0,9,10],shown:0,shutdown:9,signific:8,silent:5,similar:[5,10],simpl:[5,8,10],sinc:5,singl:[0,4,6,8],site:10,size:8,slice:[0,8,9],slide:0,small:8,smaller:0,smi:8,so:[5,8,10],solv:[9,10],solver:5,some:[0,8,10],sometim:5,sourc:[2,6,7,9,10],spawn:5,specif:[4,9,10],specifi:[5,9,10],sphinx:[6,7,9,10],split:[9,10],spmd:2,srun:5,stage:9,stage_mod:9,stanford:0,start:[0,5,8,9],state:[8,9,10],std:10,step:[0,5,9,10],still:10,store:[8,10],strategi:[0,6,10],strictli:5,style:2,subgraph:0,submesh:9,submesh_choic:9,submit:[2,8],sudo:5,suffix:5,suitabl:6,summari:6,support:[5,6,9],sure:[5,8],sync_func:10,synchron:8,synchronize_all_act:10,system:[0,4,5],tabl:6,tailor:10,take:[0,5,9,10],talk:0,target:10,task:5,techniqu:[0,6,10],tensor:[0,8,10],tensorflow:[2,5],term:0,test:[1,2,5,9,10],test_instal:5,test_torch_simpl:5,tf_path:5,than:[5,6],thank:5,thei:[0,10],them:[0,5,6,10],therefor:10,thi:[0,2,5,6,8,9,10],thing:10,think:8,third:[0,2],third_parti:[2,5],those:[0,5,8],thread:5,three:0,time:[5,6,9,10],tip:8,todo:[0,6],tofu:0,toi:9,too:9,tool:6,toolkit:5,top:[0,10],torch:5,torchdistx:5,total:[6,9,10,11],total_allocation_s:10,train:[0,4,6,7,11],train_stat:[9,10],train_step:[9,10],trainstat:[9,10],tranform:10,transform:[6,10],tri:0,tricki:8,trigger:9,trivial:9,troubl:5,truncat:10,trust:5,truth:[9,10],tune:4,tutori:[0,2,6,8,9,10,11],tutorials_jupyt:7,tutorials_python:7,two:[0,6,9],tx:[9,10],type:10,ubuntu:10,umath:5,under:5,understand:[0,8],unexpect:8,unifi:[0,4],uninstal:5,unit:2,unlik:[0,10],up:5,updat:5,upgrad:5,upper:0,upstream:5,url:5,us:[0,2,6,8,9,10],usag:[5,8],user:[0,5,8,9,10],userwarn:10,util:10,uw:0,valu:[5,8],value_and_grad:8,variabl:10,variant:0,version:[0,2],via:[2,5],view:[0,9],virtual:5,w:[9,10],wai:6,want:[5,10],warmup:10,warn:[8,9],we:[0,2,5,6,8,9,10],weight:5,well:0,what:0,when:[0,5],whether:5,which:[0,6,9,10],whl:5,whose:2,wise:8,within:9,without:[5,10],work:[6,8,10],worker:[8,9],workflow:0,workload:6,write:10,wx:[9,10],x:[0,9,10],xla:[0,2,5,10],xla_extens:10,xmap:10,y:[5,9,10],yapf:2,ye:6,you:[0,2,5,8,9,10],your:[5,8,10],zero2parallel:8,zip:7},titles:["Design and Architecture","Rationale","Developer Guide","Alpa Tutorials","Alpa Documentation","Install Alpa","Differences between alpa.parallelize and jax.pmap","Alpa Tutorials","Performance Tuning Guide","Distributed Training with Both Shard and Pipeline Parallelism","Alpa Quickstart","Computation times"],titleterms:{"import":[0,9,10],alpa:[2,3,4,5,6,7,10],an:[0,9,10],architectur:[0,4],assign:9,auto:10,automat:9,between:6,both:9,check:5,choos:8,cluster:[0,9],code:2,compar:6,comparison:10,compil:0,comput:[0,11],concept:0,connect:9,contribut:2,data:6,design:0,develop:[2,4],devic:[0,9,10],differ:6,distribut:[0,9],document:4,environ:9,exampl:0,execut:10,experiment:5,flax:5,format:2,from:5,frontend:5,get:4,graph:0,guid:[2,4,8],initi:9,instal:5,inter:0,intra:0,jax:[5,6],jaxlib:5,librari:[9,10],lint:2,manual:9,memori:10,mesh:0,method:8,mlp:[0,9,10],model:6,numpi:5,op:0,orchestratoin:0,organ:2,overhead:8,overview:0,parallel:[6,8,9,10],pass:0,perform:8,pipelin:9,pjit:6,pmap:6,prefer:6,prerequisit:5,problem:5,python:5,pytorch:5,quickstart:10,rai:9,rational:1,reduc:8,requir:5,reshard:0,runtim:[0,8],shard:9,singl:[9,10],slurm:5,sourc:5,speed:10,stage:0,start:4,through:0,time:11,train:[9,10],troubleshoot:5,tune:8,tutori:[3,4,7],unittest:2,us:5,usag:10,version:5,walk:0,wheel:5,when:6,worker:0,xmap:6}})
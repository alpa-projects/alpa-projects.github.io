Search.setIndex({docnames:["architecture/overview","architecture/parallelism-view-and-rationale","developer/developer_guide","gallery/tutorials/README","index","install","tutorials/alpa_vs_pmap","tutorials/index","tutorials/pipeshard_parallelism","tutorials/quickstart","tutorials/sg_execution_times"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["architecture/overview.rst","architecture/parallelism-view-and-rationale.rst","developer/developer_guide.rst","gallery/tutorials/README.rst","index.rst","install.rst","tutorials/alpa_vs_pmap.rst","tutorials/index.rst","tutorials/pipeshard_parallelism.rst","tutorials/quickstart.rst","tutorials/sg_execution_times.rst"],objects:{},objnames:{},objtypes:{},terms:{"0":[5,6,8,9,10],"00":[8,10],"000":10,"000gb":8,"001":[6,8],"00107553":[],"00119776":8,"00120123":[],"00122158":8,"00155965":8,"00157825":[],"00161023":8,"00176382":[],"00180223":[],"00192597":[],"001gb":8,"002":8,"002006":8,"0020567":8,"00236715":[],"00237309":8,"00268518":[],"00272335":8,"00289165":[],"002gb":8,"003":8,"00312927":8,"003gb":8,"00473658":[],"00487449":8,"004gb":8,"005":8,"005gb":8,"006gb":8,"007gb":8,"01":8,"012gb":8,"02":10,"02it":8,"03":8,"04":8,"05":8,"06":8,"063gb":8,"079757928848267":[],"07it":8,"09":8,"098gb":8,"099gb":8,"0th":[],"1":[0,5,8,9],"10":[8,9],"100":8,"1014":8,"1024":9,"11":[5,8],"12":0,"123":5,"125gb":8,"127":8,"13":8,"1333":8,"15":[8,10],"150":9,"16":8,"169":5,"16xlarg":0,"17":[],"1778":8,"1866":9,"19":8,"194gb":8,"1e":[8,9],"1e3":9,"1st":[],"2":[0,5,8,9],"20":8,"2022":8,"2048":[8,9],"21":8,"2134":8,"22":[8,9],"227":[],"229":5,"23":[],"24":8,"25":[],"250gb":8,"2540":8,"26":[],"27":8,"2732":8,"29":8,"29it":8,"2f":9,"3":[0,5,8,9],"31":[],"329163789749146":8,"33":8,"33it":[],"35it":8,"3643":8,"38":8,"383gb":8,"384gb":8,"386919260025024":8,"39":8,"4":[0,5,8,9],"407":[8,10],"4096":8,"42":9,"44":[],"44it":[],"452":5,"46":9,"47":8,"48":5,"48it":[],"49":8,"4x8":0,"5":[5,8,9],"50":9,"500gb":8,"51":8,"51it":8,"52":[],"53":9,"57":8,"574":9,"58":8,"587637662887573":8,"59":[],"5e":[8,9],"6":8,"60it":8,"64it":[],"66":8,"664gb":8,"66it":[],"67":8,"67it":[],"68":[8,9],"69it":[],"7":5,"70":8,"73":8,"74":[],"75":8,"763gb":8,"765":8,"77":8,"78":9,"79":[],"792890310287476":[],"797":[],"79it":[],"8":[0,5,8,9],"803":[],"804585218429565":8,"8080":5,"8265":8,"8266":[],"82it":[],"84it":8,"853281259536743":[],"86it":[],"87it":8,"88it":[],"9":[5,8],"90":[],"92it":8,"93":9,"94it":[],"974659442901611":[],"97it":8,"98":[],"99it":8,"case":[0,8],"catch":5,"class":[0,8,9],"do":[0,5,9],"export":[],"final":0,"function":[8,9],"import":5,"int":[8,9],"long":5,"new":[0,2],"public":2,"return":[8,9],"static":0,"try":[0,5],"while":9,A:[0,6],As:5,At:0,By:9,For:[0,5],If:[5,6],In:[0,2,6,8,9],It:0,On:6,The:[0,2,5,6,8,9],Then:[2,5,8],There:[],These:0,To:[5,8,9],With:[0,6],__call__:[8,9],_check_user_dtype_support:9,_src:9,about:0,abov:[0,9],acceler:9,accord:9,accumul:8,achiev:6,actor:[0,5],actual_st:9,adam:[8,9],addit:[2,5],addition:0,address:8,adjac:0,adjust:5,advanc:[6,9],after:9,again:8,aim:0,algorithm:[0,8],all:[0,5,7,8,9],all_gath:9,along:0,alpa:[0,8,10],alpa_train_step:9,alpa_vs_pmap:[6,10],alreadi:5,also:[0,5,6,8,9],altern:8,although:9,among:6,an:[5,6],analys:9,analyz:[0,6],ani:[0,5,9],anoth:0,api:9,appear:5,appli:[0,8,9],apply_fn:[8,9],apply_gradi:[8,9],approach:0,apt:5,ar:[0,5,6,8,9],argument:[5,9],arrai:9,art:9,articl:6,as_config:8,asarrai:9,assert_allclos:[8,9],assign:[0,6,9],atol:[8,9],attach:6,auto:8,auto_pipeline_actual_st:8,auto_pipeline_train_step:8,autom:[6,8],automat:[4,5,6,9],automatic_layer_construct:8,autosharding_option_dict:8,avail:[5,8,9],aw:0,ax:9,axi:0,b:[8,9],backward:8,bandwidth:0,base:[0,5,8],bash:[],batch:[8,9],batch_siz:[8,9],becaus:[2,8,9],been:5,befor:0,begin:9,being:[8,9],below:[0,5,6],benchmark:[2,9],benchmark_func:9,besid:6,best:[6,9],better:6,between:[0,4,7,10],billion:6,binari:[0,5],bodi:9,both:[4,6,7,10],boundari:8,bring:0,build:[2,5],build_jaxlib:[2,5],built:9,c:[2,5],call:[0,8,9],can:[0,4,5,6,8,9],cannot:[4,6],categori:0,cbc:5,cd:5,chang:6,click:[6,8,9],client:5,clone:5,cluster:[5,9],cmake:[],code:[0,5,6,7,8,9],coinor:5,com:[5,9],combin:[8,9],come:2,command:[5,8],common:[5,6],commun:[0,9],compact:[8,9],compar:9,comparison:6,compat:5,compil:[2,5,8,9],componen:0,comput:[6,8,9],conda:5,configur:9,connect:5,consist:[0,8],construct:8,contain:0,contrari:6,control:8,conv:8,convert:0,copi:[8,9],core:0,correct:[8,9],correspond:[0,5],cost:[8,9],cpu:[5,8],creat:[8,9],cross:0,cuda111:5,cuda114:5,cuda:5,cuda_vers:5,cudnn805:5,cudnn:5,cudnn_vers:5,cupi:5,current:9,custom:[0,5],dashboard:8,data:[0,4,8,9],dataset:8,decor:[8,9],deepcopi:8,deeper:0,def:[8,9],defin:[8,9],dens:[8,9],dense_0:9,depend:[0,9],describ:0,descript:0,design:4,despit:0,detail:6,dev:5,dev_instal:5,develop:5,devic:[4,6],devicearrai:9,diagram:0,differ:[0,4,7,9,10],dim:[8,9],discuss:5,disribut:8,dist:5,distinguish:0,distribut:[4,5,6,7,9,10],distributedli:9,dive:0,doc:2,document:[0,2,5],doe:9,donat:9,donate_argnum:9,dot:8,download:[6,7,8,9],drive:0,driver:8,dstirbut:4,dtype:9,dure:0,dynam:0,e:[5,8],each:[0,5,8],easier:[],ef:9,effect:5,effici:9,either:5,els:9,enabl:9,enable_cuda:5,end:6,enough:5,ensur:8,entail:0,environ:[5,9],error:5,etc:0,everi:2,exactli:0,exampl:[2,5,6,7,8,9],execut:[0,4,8,10],exist:[0,5,8],expected_st:[8,9],experiment:2,expertis:9,explain:0,explicitli:[5,9],express:0,extract:0,f:9,fact:0,fall:0,faster:9,featur:[2,5,6,8,9],few:[0,5,8],figur:0,file:10,find:[5,9],first:[0,5,8,9],fit:[4,8],fix:5,flax:[8,9],flexflow:0,float32:[8,9],float64:9,focus:8,folder:2,follow:[0,2,5,8],forc:8,fork:2,form:[0,6,8],forward:[5,8],forward_stage_layer_id:8,found:5,four:0,framework:[8,9],freed:9,from:[0,8,9],full:[0,6,8,9],fullfil:0,fulli:9,functool:9,galleri:[6,7,8,9],gb:9,gener:[0,4,6,7,8,9],get:[8,9],get_execut:9,get_total_allocation_s:9,giant:4,git:5,github:[5,9],given:9,global:9,go:6,googl:[2,9],gotcha:9,gpu:[0,5,9],grad:[8,9],gradient:8,graph:[6,8,9],ground:[8,9],group:0,gspmd:0,guarante:0,guid:5,ha:[5,9],have:[0,5],head:5,help:5,henc:0,here:[5,6,8,9],hidden_dim:[8,9],hierarchi:0,high:[0,9],hlo:[0,8],home:9,host:[2,5],how:[0,2,8],howev:[5,6,9],http:[5,8,9],hyperparamet:8,i:[5,8,9],illustr:0,ilp:5,immedi:5,implement:[0,9],improv:0,includ:[0,5,8,9],incompat:5,index:5,indic:8,individu:0,inf:8,influenc:8,info:8,inform:5,init:[8,9],initi:9,input:[0,9],instal:[2,4],instruct:[0,5],inter:8,intermedi:[0,8,9],intern:9,intra:8,introduc:0,introductori:0,involv:0,ipynb:[6,8,9],issu:5,its:0,jax:[4,7,8,9,10],jax_enable_x64:9,jaxlib:[2,9],jaxpr:[0,8],jit:9,jit_train_step:9,jnp:[8,9],job:5,jupyt:[6,7,8,9],k1:[8,9],k2:[8,9],k:8,kernel:9,kernel_np:9,knois:[8,9],know:9,ksampl:[8,9],larg:[4,6,9],latenc:[0,8],later:9,launch:5,lax:9,lax_intern:9,lax_numpi:9,layer:8,layer_construct:8,layer_num:8,learn:[0,9],learning_r:[8,9],less:6,let:8,level:[0,9],librari:5,like:0,line:6,linen:[8,9],list:0,lm:0,local:[0,2],local_devic:9,logical_mesh_shap:8,look:0,loop:9,loss:[8,9],loss_func:[8,9],lower:[0,9],m:0,machin:[0,9],made:0,mai:[8,9],mainli:2,maintain:2,make:5,manag:[0,5,8],mani:[0,5,8],manual:9,manual_layer_construct:8,manual_pipeline_actual_st:8,manual_pipeline_model:8,manual_pipeline_st:8,manual_pipeline_train_step:8,manualpipelinemlpmodel:8,map:[0,9],mark:8,mark_pipelin:[],mark_pipeline_boundari:8,mark_typ:[],marker:8,materi:0,max_n_succ_stag:8,mb:10,mean:[5,8,9],megatron:0,mem:8,memori:6,mesh:8,method:[0,8],might:[0,5],min:0,minim:[0,8],minut:[6,8,9],ml:0,mlpmodel:[8,9],mode:5,model:[0,8,9],modif:8,modifi:[2,5],modul:[5,8,9],more:[0,5,6,9],most:6,move:5,ms:9,multipl:[0,8],n:0,name:[],nccl:5,necessari:[0,8],need:[5,8,9],network:[4,5,8,9],neural:[4,5,9],new_stat:[8,9],newer:5,next:[0,5],nn:[8,9],node:[0,5],non:8,nontrivi:9,normal:[8,9],note:[5,8],notebook:[6,7,8,9],noth:5,now:[0,5,8],np:9,npy:8,num_lay:9,num_micro_batch:8,numba:[],number:[0,8,9],numpi:[8,9],nvidia:0,nvlink:0,offici:5,onc:0,one:[0,9],onli:[5,8,9],op:8,open:5,oper:[0,4,6,8,9],optax:[5,8,9],optim:[0,8,9],option:[8,9],orchestr:0,organ:0,origin:[0,5,9],orthogon:0,other:[0,5],otherwis:5,our:[0,5],out:[5,8,9],output:9,overhead:0,own:5,p3:0,packag:5,page:5,pair:0,paper:0,paralel:9,parallel:[0,4,7,10],parallel_execut:9,param:[8,9],paramet:[6,8,9],paramt:[8,9],parcip:0,part:0,parti:2,partial:[0,9],particular:5,partit:[0,6,8],pass:[5,8],path:[],peak:8,per:[5,9],perform:[0,6,8],permiss:5,pick:6,pip3:5,pip:[2,5],pipelin:[0,4,6,7,9,10],pipeline_parallel:8,pipeshard_parallel:[8,10],pipeshardparallel:8,pjit:9,placement:0,plan:[0,2,4,9],playground:2,pleas:[0,2,5],pmap:[4,7,9,10],pmap_lib:9,pmean:9,post:0,prebuilt:5,precis:0,preshard_dynamic_arg:9,primit:9,print:[5,9],prngkei:[8,9],problem:[8,9],process:[0,5,8],profil:8,program:0,project:5,prospector:2,provid:[5,6,9],proxi:5,pull:2,pulp:[],purpos:9,pwd:5,py:[5,6,8,9,10],pybind11:[],pypi:5,python3:5,python:[2,6,7,8,9],quick:8,quickstart:[4,7,10],rai:[0,5],random:[8,9],rang:9,rational:0,read:0,realiz:0,rebas:5,recommend:[0,5],recompil:5,recurs:5,reduc:9,regardless:5,regularli:5,reinstal:5,reli:5,relu:[8,9],repeat:9,repo:[2,5],repositori:[2,5],repres:0,represent:[0,9],request:[2,5,9],requir:[0,6,8,9],research:0,resid:2,resourc:5,result:[8,9],reus:8,rngkei:[8,9],run:[0,2,5,6,8,9],runtime_execut:9,runtimeerror:5,s:[0,2,8,9],same:[5,6,8,9],save:8,scale:[4,9],schedul:0,scheme:[0,9],scipi:[],script:[2,5,6,8,9],second:[6,8,9],section:5,see:[5,9],self:[5,8,9],send:0,separ:8,seper:8,serial:9,serial_execut:9,server:5,servic:[2,8],set:[0,9],setup:5,sever:[0,6,8],sh:2,shard:[0,4,7,10],shardeddevicearrai:9,shell:9,should:2,show:[0,8,9],shown:0,shutdown:8,similar:9,simpl:[5,9],sinc:5,singl:[0,4,6],slice:[0,8],smaller:0,so:[5,9],solv:[8,9],solver:5,some:[0,9],sometim:5,sourc:[2,6,7,8,9],spawn:5,specif:[4,8,9],specifi:[5,8,9],sphinx:[6,7,8,9],split:[8,9],spmd:2,srun:5,stage:8,stage_mod:8,start:[0,5,8],state:[8,9],std:9,step:[0,5,8,9],still:9,store:9,strategi:[0,6,9],style:2,subgraph:0,submesh:8,submesh_choic:8,submit:2,sudo:5,suffix:5,suitabl:6,summari:6,support:[6,8],sure:5,sync_func:9,synchronize_all_act:9,system:[0,4,5],tabl:6,tailor:9,take:[0,5,8,9],talk:0,target:9,task:5,techniqu:[0,6,9],tensor:[0,9],tensorflow:[2,5],tensorstor:[],term:0,test:[1,2,5,8,9],test_instal:5,tf_path:5,than:[5,6],thei:[0,9],them:[0,5,6,9],therefor:9,thi:[0,2,5,6,8,9],thing:9,third:[0,2],third_parti:[2,5],those:[0,5],thread:5,three:0,time:[5,6,8,9],todo:[0,6],tofu:0,toi:8,too:8,tool:6,toolkit:5,top:[0,9],total:[6,8,9,10],total_allocation_s:9,tqdm:[],train:[0,4,6,7,10],train_stat:[8,9],train_step:[8,9],trainstat:[8,9],tranform:9,transform:[6,9],tri:0,trigger:8,trivial:8,troubl:5,truncat:9,trust:5,truth:[8,9],tutori:[0,2,6,8,9,10],tutorials_jupyt:7,tutorials_python:7,two:[0,6,8],tx:[8,9],type:9,ubuntu:9,under:5,understand:0,unifi:[0,4],unit:2,unlik:[0,9],up:5,updat:5,upgrad:5,upper:0,upstream:5,us:[0,2,6,8,9],user:[0,5,8,9],userwarn:9,util:9,valu:5,variabl:9,variant:0,version:[0,2],via:[2,5],view:[0,8],w:[8,9],wai:6,want:[5,9],warmup:9,warn:8,we:[0,2,5,6,8,9],well:0,what:0,when:[0,5],whether:5,which:[0,6,8,9],whose:2,within:8,without:[5,9],work:[6,9],worker:8,workflow:0,workload:6,write:9,wx:[8,9],x:[0,8,9],xla:[0,2,5,9],xla_custom_call_mark:[],xla_extens:9,xmap:9,y:[8,9],yapf:2,ye:6,you:[0,2,5,8,9],your:[5,9],zip:7},titles:["Design and Architecture","Rationale","Developer Guide","Alpa Tutorials","Alpa Documentation","Install Alpa","Differences between alpa.parallelize and jax.pmap","Alpa Tutorials","Distributed Training with Both Shard and Pipeline Parallelism","Alpa Quickstart","Computation times"],titleterms:{"import":[0,8,9],alpa:[2,3,4,5,6,7,9],an:[0,8,9],architectur:[0,4],assign:8,auto:9,automat:8,between:6,both:8,check:5,cluster:[0,8],code:2,compar:6,comparison:9,compil:0,comput:[0,10],concept:0,connect:8,contribut:2,data:6,design:0,develop:[2,4],devic:[0,8,9],differ:6,distribut:[0,8],document:4,environ:8,exampl:0,execut:9,flax:5,format:2,from:5,get:4,graph:0,guid:[2,4],initi:8,instal:5,inter:0,intra:0,jax:[5,6],jaxlib:5,librari:[8,9],lint:2,manual:8,memori:9,mesh:0,mlp:[0,8,9],model:6,op:0,orchestratoin:0,organ:2,overview:0,parallel:[6,8,9],pass:0,pipelin:8,pmap:6,prefer:6,prerequisit:5,problem:5,python:5,quickstart:9,rai:8,rational:1,requir:5,reshard:0,runtim:0,shard:8,singl:[8,9],slurm:5,sourc:5,speed:9,stage:0,start:4,through:0,time:10,train:[8,9],troubleshoot:5,tutori:[3,4,7],unittest:2,us:5,usag:9,version:5,walk:0,wheel:5,when:6,worker:0,xmap:6}})
Search.setIndex({docnames:["architecture/overview","architecture/parallelism-view-and-rationale","developer/developer_guide","gallery/tutorials/README","index","install/from_source","tutorials/alpa_vs_pmap","tutorials/getting_started","tutorials/index","tutorials/pipeshard_parallelism","tutorials/sg_execution_times"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["architecture/overview.rst","architecture/parallelism-view-and-rationale.rst","developer/developer_guide.rst","gallery/tutorials/README.rst","index.rst","install/from_source.rst","tutorials/alpa_vs_pmap.rst","tutorials/getting_started.rst","tutorials/index.rst","tutorials/pipeshard_parallelism.rst","tutorials/sg_execution_times.rst"],objects:{},objnames:{},objtypes:{},terms:{"0":[5,6,7,9,10],"00":10,"000":[6,9,10],"0th":9,"1":[0,5,7,9],"10":7,"1024":7,"11":5,"12":0,"16":9,"16xlarg":0,"1866":7,"1e":[7,9],"1e3":7,"1st":9,"2":[0,7,9],"2048":[7,9],"209":7,"28":7,"2f":7,"3":[0,5,7,9],"4":[0,5,7,9],"4x8":0,"5":7,"50":7,"51":[7,10],"543":[7,10],"5e":[7,9],"69":7,"7":5,"71":7,"78":7,"8":[0,5,7],"81":7,"82":7,"case":[0,9],"class":[0,7,9],"do":[0,2,7],"export":5,"final":0,"function":[2,7,9],"import":5,"int":[7,9],"new":[0,9],"public":2,"return":[7,9],"static":0,"try":[0,5],"while":7,A:[0,6],At:0,By:7,For:0,If:[5,6],In:[0,6,7,9],It:0,On:6,The:[0,2,6,7,9],Then:[2,9],There:2,These:0,To:[5,7,9],With:[0,6],__call__:[7,9],_check_user_dtype_support:7,_src:7,about:0,abov:[0,7],acceler:7,accord:7,accumul:9,achiev:6,actor:[0,9],actual:9,actual_st:7,adam:[7,9],addit:2,addition:0,address:9,adjac:0,advanc:[6,7],after:7,again:9,aim:0,algorithm:[0,9],all:[0,5,7,8],all_gath:7,along:0,alpa:[0,10],alpa_train_step:7,alpa_vs_pmap:[6,10],alreadi:5,also:[0,6,7,9],altern:9,although:7,among:6,an:6,analys:7,analyz:[0,6],ani:[0,2,7],anoth:0,api:7,appli:[0,7,9],apply_fn:[7,9],apply_gradi:[7,9],approach:0,apt:5,ar:[0,2,5,6,7,9],argument:7,arrai:7,art:7,articl:6,asarrai:7,assert_allclos:[7,9],assign:[0,6,7,9],atol:[7,9],attach:6,auto:9,auto_pipeline_actual_st:9,auto_pipeline_train_step:9,auto_stag:9,autom:[6,9],automat:[2,6,7],automatic_layer_construct:9,avail:7,avoid:9,aw:0,ax:7,axi:0,b:[7,9],backward:9,bandwidth:0,base:[0,9],bash:5,batch:[7,9],batch_siz:[7,9],becaus:[7,9],befor:0,begin:7,being:[7,9],below:[0,5,6,9],benchmark:[2,7],benchmark_func:7,besid:[6,9],best:[6,7],better:6,between:[0,8,10],billion:6,binari:[0,5],bodi:7,both:[6,8,10],bring:0,build:[2,5],built:7,c:[2,5],call:[0,5,7],can:[0,5,6,7,9],cannot:6,categori:0,cbc:5,cd:5,chang:[2,6],click:[6,7,9],clone:5,cluster:[7,9],cmake:5,code:[0,5,6,7,8,9],coinor:5,com:[5,7],combin:7,command:[5,9],common:6,commun:[0,7],compact:[7,9],compar:7,comparison:6,compil:[2,7],componen:0,comput:[6,7,9],conda:5,config:9,configur:7,connect:9,consist:[0,9],construct:9,contain:0,contrari:6,control:9,convert:0,copi:[7,9],core:0,correct:[7,9],correspond:0,cost:7,cpu:9,creat:[7,9],cross:0,cuda114:5,cuda:5,cudnn:5,cupi:5,current:7,custom:[0,5],data:[0,7,9],dataset:9,decor:[7,9],deepcopi:9,deeper:0,def:[7,9],defin:[7,9],dens:[7,9],dense_0:7,depend:[0,5,7],describ:0,descript:0,design:[4,7],despit:0,detail:6,dev_instal:5,develop:5,devic:6,device_clust:9,devicearrai:7,deviceclust:9,diagram:0,differ:[0,7,8,10],dim:[7,9],dist:5,distinguish:0,distribut:[6,7,8,10],distributedli:7,dive:0,doc:2,document:[0,2],doe:7,donat:7,donate_argnum:7,download:[6,7,8,9],drive:0,driver:9,dtype:7,dure:0,dynam:0,e:[5,9],each:[0,9],easier:2,effect:5,effici:7,els:7,enabl:[7,9],enable_cuda:5,end:[6,9],ensur:9,entail:0,env:7,environ:7,etc:0,exactli:0,exampl:[2,6,7,8,9],execut:[0,9,10],exist:[0,9],expected_st:[7,9],experiment:2,expertis:7,explain:0,explicitli:7,express:0,extract:0,f:7,fact:0,fall:0,faster:7,featur:[6,7,9],few:0,figur:0,file:10,find:7,first:[0,5,7,9],fit:9,flax:[5,7,9],flexflow:0,float32:7,float64:7,focus:9,folder:2,follow:[0,2,5,9],forc:9,fork:[2,5],form:[0,6,9],forward:9,four:0,freed:7,from:[0,7,9],full:[0,6,7,9],fullfil:0,fulli:7,functool:7,galleri:[6,7,8,9],gb:7,gener:[0,6,7,8,9],get:[8,9,10],get_execut:[7,9],get_total_allocation_s:7,get_virtual_physical_mesh:9,getting_start:[7,10],git:5,github:[5,7],given:7,global:7,go:6,googl:[2,7],gotcha:7,gpu:[0,7,9],grad:[7,9],gradient:9,graph:[6,7,9],ground:[7,9],group:0,gspmd:0,guarante:0,guid:[5,9],ha:[5,7],have:[0,5],head:5,henc:0,here:[5,6,7,9],hidden_dim:[7,9],hierarchi:0,high:[0,7],hlo:0,how:[0,9],howev:[6,7],http:7,hyperparamet:9,i:[7,9],illustr:0,ilp:5,immedi:5,implement:[0,7],improv:0,includ:[0,7,9],indic:9,individu:0,init:[7,9],initi:7,input:[0,7],instal:2,instruct:[0,5],inter:9,intermedi:[0,7],intern:7,intra:9,introduc:0,introductori:0,involv:0,ipynb:[6,7,9],its:[0,5],jax:[2,5,7,8,9,10],jax_enable_x64:7,jax_platform_nam:9,jaxlib:[5,7],jaxpr:0,jit:7,jit_train_step:7,jnp:[7,9],jupyt:[6,7,8,9],k1:[7,9],k2:[7,9],k:9,kernel:7,kernel_np:7,knois:[7,9],know:7,ksampl:[7,9],larg:[6,7],latenc:[0,9],later:7,lax:7,lax_intern:7,lax_numpi:7,layer:9,layer_num:9,learn:[0,7],learning_r:[7,9],less:6,level:[0,7],lib:7,like:0,line:6,linen:[7,9],list:0,lm:0,local:0,local_devic:7,look:0,loop:7,loss:[7,9],loss_func:[7,9],lower:[0,7],m:0,machin:[0,7],made:0,mai:7,mainli:2,make:2,manag:[0,9],mani:[0,9],manual:7,manual_layer_construct:9,manual_pipeline_actual_st:9,manual_pipeline_model:9,manual_pipeline_st:9,manual_pipeline_train_step:9,manualpipelinemlpmodel:9,map:[0,7],mark:9,mark_pipelin:9,mark_typ:9,marker:[5,9],materi:0,mb:10,mean:[5,7,9],megatron:0,memori:[6,9],mesh:9,method:0,microbatch:9,might:0,min:0,minim:[0,9],minut:[6,7,9],ml:0,mlpmodel:[7,9],mode:[5,9],model:[0,7,9],modif:9,modifi:[2,5],modul:[7,9],more:[0,6,7],most:6,ms:7,multipl:[0,9],n:0,name:9,nccl:5,necessari:[0,9],need:[5,7,9],network:7,neural:7,new_stat:[7,9],next:0,nn:[7,9],node:0,nontrivi:7,normal:[7,9],note:9,notebook:[6,7,8,9],noth:5,now:[0,9],np:7,num_lay:7,num_micro_batch:9,numba:5,number:[0,7,9],numpi:[5,7,9],nvidia:0,nvlink:0,occupi:9,offici:5,onc:0,one:[0,7],onli:[5,7,9],oper:[0,6,7,9],optax:[7,9],optim:[0,7,9],option:7,orchestr:0,organ:0,origin:[0,7],orthogon:0,other:0,otherwis:5,our:0,out:[7,9],output:7,overhead:0,own:5,p3:0,packag:[5,7],pair:0,paper:0,paralel:7,parallel:[0,8,10],parallel_execut:7,param:[7,9],paramet:[6,7,9],paramt:[7,9],parcip:0,part:0,partial:[0,7],partit:[0,6,9],pass:9,path:5,per:7,perform:[0,6,9],permiss:5,pick:6,pip3:5,pip:2,pipelin:[0,5,6,7,8,10],pipeline_parallel:5,pipeline_stage_mod:9,pipeshard_parallel:[9,10],pjit:7,placement:0,plan:[0,2,7],playground:2,pleas:[0,2,5],pmap:[7,8,10],pmap_lib:7,pmean:7,post:0,precis:0,preshard_dynamic_arg:7,primit:7,print:[5,7],prngkei:[7,9],problem:7,process:[0,9],program:0,project:5,prospector:2,provid:[6,7],pull:2,pulp:5,purpos:7,py:[5,6,7,9,10],pybind11:5,python3:[5,7],python:[2,5,6,7,8,9],rai:[0,5,9],random:[7,9],rang:7,rational:0,read:0,realiz:0,recommend:0,recompil:5,reduc:7,relat:9,relu:[7,9],repeat:7,repo:5,repositori:2,repres:0,represent:[0,7],request:[2,7],requir:[0,6,7,9],research:0,resid:2,result:7,reus:9,rngkei:[7,9],run:[0,2,5,6,7,9],runtime_execut:7,s:[0,7],same:[6,7,9],scale:7,schedul:0,scheme:[0,7],scipi:5,script:[2,5,6,7,9],second:[6,7,9],see:7,self:[7,9],send:0,seper:9,serial:7,serial_execut:7,servic:2,set:[0,7,9],set_parallelize_opt:9,sever:[0,6],sh:[2,5],shard:[0,8,10],shardeddevicearrai:7,shell:7,show:[0,7,9],shown:0,shutdown:9,similar:7,simpl:7,singl:[0,6],site:7,slice:[0,9],smaller:0,so:[5,7],solv:7,solver:5,some:[0,7],sourc:[2,6,7,8,9],specif:[7,9],specifi:[7,9],sphinx:[6,7,8,9],split:[7,9],spmd:2,stage:9,start:[0,5,8,9,10],state:[7,9],std:7,step:[0,5,7,9],still:7,store:7,strategi:[0,6,7,9],style:2,subgraph:0,submesh:9,submit:2,sudo:5,suitabl:6,summari:6,support:[6,9],sync_func:7,synchronize_all_act:7,system:[0,5],tabl:6,tailor:7,take:[0,5,7],talk:0,target:7,techniqu:[0,6,7],tensor:0,tensorflow:[2,5],tensorstor:5,term:0,termin:9,test:[1,2,5,7,9],test_instal:5,tf_path:5,than:6,thei:[0,7],them:[0,6,7],therefor:[7,9],thi:[0,2,5,6,7,9],thing:7,third:0,those:0,three:0,time:[6,7,9],todo:[0,6],tofu:0,toi:9,tool:6,toolkit:5,top:[0,7],total:[6,7,9,10],total_allocation_s:7,tqdm:5,train:[0,6,8,10],train_stat:[7,9],train_step:[7,9],trainstat:[7,9],tranform:7,transform:[6,7],tri:0,truncat:7,truth:[7,9],tutori:[0,2,6,7,9,10],tutorials_jupyt:8,tutorials_python:8,two:[0,2,6,9],tx:[7,9],type:7,understand:0,unifi:0,unit:2,unlik:[0,7],updat:[5,9],upper:0,us:[0,2,5,6,7,9],user:[0,7,9],userwarn:7,util:7,variabl:7,variant:0,version:[0,5],via:[2,5],view:0,w:[7,9],wai:6,want:7,warmup:7,we:[0,2,5,6,7,9],well:0,what:0,when:0,whether:5,which:[0,2,6,7,9],within:9,without:7,work:[6,7],workflow:0,workload:6,write:7,wx:[7,9],x:[0,7,9],xla:[0,2,5,7],xla_custom_call_mark:5,xla_extens:7,xmap:7,y:[7,9],yapf:2,ye:6,you:[0,2,5,7,9],your:[5,7],zip:8},titles:["Design and Architecture","Rationale","Developer Guide","Alpa Tutorials","Alpa documentation","Install Alpa","Difference between alpa.parallelize and jax.pmap","Getting Started with Alpa","Alpa Tutorials","Distributed Training with Both Shard and Pipeline Parallelism","Computation times"],titleterms:{"import":[0,7,9],alpa:[2,3,4,5,6,7,8,9],an:[0,7,9],architectur:[0,4],auto:7,automat:9,between:6,both:9,check:5,cluster:0,code:2,compar:6,comparison:7,compil:0,comput:[0,10],concept:0,contribut:2,data:6,design:0,develop:[2,4],devic:[0,7,9],differ:6,distribut:[0,9],document:4,environ:9,exampl:0,execut:7,format:2,from:5,get:7,graph:0,guid:[2,4],initi:9,instal:[4,5],inter:0,intra:0,jax:6,librari:[7,9],lint:2,manual:9,memori:7,mesh:0,mlp:[0,7,9],model:6,op:0,orchestratoin:0,organ:2,overview:0,parallel:[6,7,9],pass:0,pipelin:9,pmap:6,prefer:6,rational:1,requir:5,reshard:0,runtim:0,shard:9,singl:[7,9],sourc:5,speed:7,stage:0,start:7,through:0,time:10,train:[7,9],tutori:[3,4,8],usag:7,walk:0,when:6,worker:0,xmap:6}})
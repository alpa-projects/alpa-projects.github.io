Search.setIndex({docnames:["architecture/alpa_compiler_walk_through","architecture/intra_op_solver","architecture/overview","architecture/parallelism-view-and-rationale","benchmark/benchmark","developer/developer_guide","gallery/tutorials/README","index","install","tutorials/alpa_on_slurm","tutorials/alpa_vs_pmap","tutorials/faq","tutorials/icml_big_model_tutorial","tutorials/index","tutorials/opt_serving","tutorials/perf_tuning_guide","tutorials/pipeshard_parallelism","tutorials/quickstart","tutorials/sg_execution_times"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["architecture/alpa_compiler_walk_through.rst","architecture/intra_op_solver.rst","architecture/overview.rst","architecture/parallelism-view-and-rationale.rst","benchmark/benchmark.rst","developer/developer_guide.rst","gallery/tutorials/README.rst","index.rst","install.rst","tutorials/alpa_on_slurm.rst","tutorials/alpa_vs_pmap.rst","tutorials/faq.rst","tutorials/icml_big_model_tutorial.rst","tutorials/index.rst","tutorials/opt_serving.rst","tutorials/perf_tuning_guide.rst","tutorials/pipeshard_parallelism.rst","tutorials/quickstart.rst","tutorials/sg_execution_times.rst"],objects:{},objnames:{},objtypes:{},terms:{"0":[5,8,9,10,11,14,16,17,18],"00":[9,18],"000":[16,18],"000gb":[],"001":[10,16],"00105005":[],"00115792":[],"00148469":[],"00149446":[],"00153695":[],"00156432":[],"00159595":[],"00162239":[],"00178525":[],"00179476":[],"0019203":[],"0019856":[],"00198701":[],"001gb":[],"002":16,"00202494":[],"00203413":[],"00232795":[],"00238567":[],"00239089":[],"00245696":[],"00256801":[],"00274867":[],"00275159":[],"00278576":[],"00279755":[],"00297202":[],"002gb":[],"003":16,"00306678":[],"00313377":[],"003gb":[],"004":16,"00438674":[],"00445016":[],"00477897":[],"00477968":[],"004gb":[],"005":[],"00510118":[],"005gb":[],"006":16,"006gb":[],"007":16,"007gb":[],"008":16,"01":[16,17],"012":16,"012gb":[],"02":[],"03":18,"031":16,"032":16,"035":16,"036":16,"05":8,"050":16,"052":16,"058":16,"060":16,"063":16,"063gb":[],"064":16,"065":16,"066":16,"067":16,"068":16,"069":16,"078gb":[],"08":16,"09":[16,18],"094gb":[],"096":16,"097gb":[],"098":16,"098gb":[],"099gb":[],"0xd":8,"0xf":8,"1":[1,2,4,9,14,16,17],"10":[9,17],"1000":14,"1014":[],"102":16,"1024":[14,17],"109gb":[],"11":[8,9,14],"112":16,"114":16,"116":16,"12":8,"122":16,"125":16,"125gb":[],"125m":14,"126":16,"127":16,"129":16,"13":16,"130":16,"132":16,"133":16,"1333":[],"134":16,"14":[5,16],"148":17,"15":[],"1500":14,"1525":16,"156gb":[],"159":16,"16":[0,9,14,16],"16gb":9,"16xlarg":[2,14],"17":8,"174":16,"175b":7,"181de4f5577a72c9b30525ed3da09e5b2138cc2c":1,"189":16,"190":16,"191":16,"192gb":[],"1939":[],"193gb":[],"194gb":[],"195":16,"1e":[16,17],"1e3":17,"1gb":9,"2":[0,1,2,5,9,14,16,17],"20":8,"202":16,"2022":[8,12],"2023":16,"2032":[],"2048":[16,17],"21":8,"2134":[],"22":[2,7,8,17],"221":16,"223":16,"226":16,"23":[14,17],"230":16,"24":[],"25":16,"250":16,"250gb":[],"251":16,"251gb":[],"252":16,"252gb":[],"254":16,"2540":[],"256":14,"257":16,"264":16,"266":16,"27":[16,17],"280":[],"29":16,"2d":0,"2f":17,"3":[2,8,9,14,16,17],"30":16,"30b":14,"31":[],"314":16,"316":16,"32":5,"33":17,"3363":[],"34":17,"346":16,"348":16,"35":8,"350gb":14,"377":16,"379":16,"38":16,"383gb":[],"384gb":[],"3873":[],"4":[0,2,8,14,16,17],"4096":[],"439":16,"441":16,"444":16,"451":16,"452":8,"459":16,"461":8,"47":16,"496":8,"4x8":2,"5":[8,9,17],"50":[16,17],"500gb":[],"501gb":[],"502gb":[],"512":14,"52":17,"53":16,"56":17,"560m":[9,14],"57":8,"5e":[16,17],"664":16,"664gb":[],"66b":14,"67":[],"6789":9,"689":16,"691":16,"694":16,"7":[8,9],"700gb":14,"71":16,"710782":8,"712":[16,18],"721260d122f096040762b2d226b37e8ab23f74b8":1,"73":16,"76":17,"763gb":[],"76976db8412b60d322c680a5822116ba6f2f762a":8,"78":17,"7b":14,"8":[2,4,8,9,14,16,17],"8001":14,"80gb":14,"8265":16,"8266":[],"83":8,"858":[],"87":17,"9":[8,9,16],"90":[],"944":17,"992":14,"break":1,"byte":14,"case":[0,2,9,14,15,17],"catch":8,"class":[0,2,16,17],"default":[8,9],"do":[0,2,5,8,9,14,15,17],"export":9,"final":2,"function":[0,16,17],"import":[0,8,14],"int":[0,16,17],"long":8,"new":[0,2,5,8,14],"public":5,"return":[0,9,16,17],"static":2,"switch":8,"throw":14,"true":14,"try":[2,8,9,14,15],"while":[0,8,9,17],A:[0,2,9,10,14],As:[8,9,14,17],At:[2,9],By:[9,17],For:[0,2,8,9,11,14,16],IFS:9,If:[5,8,9,10,11,14,15,16],In:[0,2,5,9,10,14,15,16,17],It:[0,2,8],No:8,Not:14,On:[8,9,10],The:[0,1,2,4,5,8,9,10,14,15,16,17],Then:[0,8,9,14,16],There:[0,14],These:[2,8,9,15],To:[0,8,9,15,16,17],With:[2,10,14],__call__:[0,16,17],_get_full_batch_apply_grad:0,_multiarray_umath:8,a100:14,abl:14,abort:8,about:[2,8,14],abov:[0,2,14,16,17],acceler:[0,14,17],access:[8,9,14,15],accord:[0,17],accordingli:15,accumul:[0,15,16],accumulate_grad:0,accumulated_grad:0,achiev:[10,17],acitv:14,activ:[9,17],actor:[2,8],actual_st:17,ad:[0,9],adam:[15,16,17],add:[0,9],add_bos_token:14,addit:[0,5,8,14,16],addition:[0,2,5],addr:9,address:[8,9,14,16],adf:[],adjac:2,adjust:8,advanc:[10,11,12,15,16,17],advantag:14,affect:15,after:[0,1,8,9,17],again:[8,16],against:8,ai:2,aim:2,algorithm:[0,2,16],all:[0,1,2,8,9,13,14,16,17],all_gath:17,alloc:15,allow:9,along:2,alpa:[1,2,4,12,15,16,18],alpa_cost:17,alpa_debug_print_as_strategi:1,alpa_environ:9,alpa_execut:17,alpa_train_step:17,alpa_vs_pmap:[10,18],alreadi:[8,9,14],also:[0,2,8,9,10,14,15,16,17],altern:16,although:17,alwai:0,among:10,an:[0,2,4,8,9,10,14,15],analys:[15,17],analysi:[0,1],analyz:[2,10,17],ani:[2,8,17],annot:0,anoth:[2,8,9,14],api:[0,8,17],app:14,appear:9,appli:[2,9,11,14,16,17],applic:8,apply_fn:[0,16,17],apply_grad:0,apply_gradi:[0,16,17],approach:2,appropri:14,approxim:14,ar:[0,1,2,8,9,10,11,12,14,15,16,17],arbitrari:0,architectur:[14,15],argument:[0,8,9,14,15,17],around:14,arrai:17,art:17,articl:10,as_config:[],asdf:[],ask:[7,9],assert_allclos:[16,17],assign:[0,2,9,10,17],assum:9,asum:9,atol:[16,17],attach:10,auto:[1,15,16],auto_pipeline_actual_st:16,auto_pipeline_train_step:16,auto_shard:1,auto_sharding_dot_handl:1,auto_sharding_util:1,autograd:0,autolayeropt:[15,16],autom:[10,16],automat:[0,9,10,14,15,17],autoshard:0,autosharding_option_dict:16,autotoken:14,avail:[8,9,12,14,16],available_memori:16,avoid:15,aw:[2,4,14],ax:17,axi:2,axis_nam:17,b:[16,17],back:[0,8,17],backend:14,background:[9,12],backward:[0,8,16],bandwidth:2,base:[0,1,2,14,16],bash:9,basic:[1,15],batch:[0,1,14,15,16,17],batch_decod:14,batch_siz:[16,17],bazel:8,bazel_opt:8,becaus:[0,5,8,14,15,16,17],been:8,befor:[0,1,2,8,9,11,14],begin:17,behav:0,behavior:15,being:[16,17],below:[0,1,2,4,5,8,9,10,14],benchmark:[5,17],benchmark_func:17,besid:10,best:[10,15,17],better:[10,17],between:[0,2,7,8,13,18],big:[7,14,15],bigscienc:14,billion:[4,10],bin:9,binari:2,bio:8,blob:1,block:[9,15],blog:2,bloom:[9,14],bodi:[16,17],boost:14,both:[0,7,10,13,17,18],boundari:[0,16],bring:2,browser:14,build:[5,8,14],build_jaxlib:[5,8],built:17,c:[1,5,8],cach:[8,14],calcul:0,call:[0,1,2,16,17],can:[0,1,2,4,5,8,9,10,11,14,15,16,17],cannot:[8,10,14],capit:14,captur:0,categori:2,caus:8,caveat:11,cc:[1,8],cd865615b9b518bc507fbdc71dc44c7cc76618ac:1,cd:[8,14],chang:[9,10],check:[1,5,14],checkout:8,checkpoint:[0,14],checkpoint_last:14,chex:8,choic:15,choos:8,choosen:1,chunk:[9,14],citi:14,ckpt:14,clean:8,click:[10,16,17],client:[8,14],clone:[8,14],cluster:[0,4,8,9,11,14,15,17],cluster_layers_and_slice_mesh:0,code:[0,2,7,8,10,13,14,16,17],collect:[9,14],com:[1,8,12,14],combin:[9,14,15,16,17],come:5,command:[5,8,9,15,16],commandlin:9,commit:[0,5],commod:14,common:[8,9,10,17],commun:[2,17],compact:[0,16,17],compar:[0,17],comparison:10,compat:[8,9,14],compil:[1,5,7,8,14,16,17],compile_pipeshard_execut:0,compile_pipeshard_executable_intern:0,complet:0,complic:[1,15],compon:1,componen:2,comput:[0,10,15,17],compute_cost:16,compute_grad:0,compute_grad_input:0,compute_grad_to_accumulate_grad:0,concat:0,concaten:15,concept:12,conda:9,configur:[11,15,16],connect:[8,9,14],consist:[2,16],consolid:14,constant:14,constraint:14,construcion:16,construct:[15,16],contain:[1,2,8,9],contrari:10,contrast:17,contributor:5,control:[8,14,15,16],convert:[9,17],copi:16,core:[2,8],correct:[0,16,17],correctli:[8,9,15],correspond:[0,2,8,14],cost:[1,16,17],could:8,cover:[9,12],cpu:[8,9,15,16],creat:[16,17],create_donation_map:0,cross:2,ctrl:9,cu113:14,cuda111:8,cuda114:8,cuda:[9,14],cuda_vers:8,cudnn805:8,cudnn:[8,9],cudnn_vers:8,cupi:8,cupy_backend:8,custom:[0,2,8],d987466b444ac0dbb9dd8c841bb0d960aed94fdd:[],d:[8,9],dashboard:16,data:[0,2,15,16],data_parallel_execut:17,dataparallel:15,dataset:16,deactiv:9,debug:[0,15],decor:[0,17],deep:17,deepcopi:16,deeper:2,def:[0,16,17],defin:[0,9,14,16,17],definit:0,demo:12,dens:[0,16,17],dense_0:17,depend:[2,8,14,15,17],deploi:9,deriv:0,describ:2,descript:2,design:[7,8,12,14],despit:2,detail:[0,8,10,14],detect:15,dev:8,dev_instal:8,develop:8,devic:[0,10,15],device_put_repl:17,device_put_shard:17,devicearrai:17,devices_per_nod:16,diagram:2,did:[14,15],differ:[0,2,7,9,13,14,15,17,18],dim:[1,16,17],direct:8,directli:[0,9],directori:9,disabl:8,disable_tqdm_glob:16,discuss:8,disk:14,disribut:16,dist:8,distinguish:[0,2],distribut:[0,2,7,10,13,14,17,18],distributedarrai:15,distributedli:17,dive:2,dma:8,do_sampl:14,doc:5,docstr:11,document:[0,2,5,8],doe:[15,17],doesn:0,don:9,donat:[0,17],donate_argnum:17,done:[0,9],doubl:8,downgrad:8,download:[8,10,13,14,16,17],dram:8,drive:2,driver:[8,14,15,16],dropvar:0,dtype:15,due:[8,17],dump:8,dure:2,dynam:2,e:[0,8,9,14,16],each:[0,1,2,8,9,14,16],easier:15,echo:9,edg:1,effect:8,effici:[4,14,16,17],either:[8,14],element:15,elementwis:1,els:[9,17],embed:0,enabl:[8,15,16],enable_cuda:8,encod:14,encoder_chunk_s:14,end:[0,10],enough:[8,17],ensur:16,entail:2,entir:14,entranc:1,environ:[1,8,11],equal:16,equat:0,equival:9,error:[5,15],especi:15,etc:[2,14],eventu:0,everi:5,exactli:[0,2,9],exampl:[0,2,5,8,9,10,11,13,14,16,17],exce:9,except:14,execut:[0,2,9,14,15,16,18],exist:[2,8,16],expect:[9,15],expected_st:[16,17],experiment:[5,8],expertis:17,explain:2,explan:4,explicitli:8,express:2,extern:8,extra:[8,14],extract:2,f:[8,17],facebook:14,fact:2,fail:[8,14,15],fall:2,fals:14,familiar:[11,14],fanci:14,faq:7,fastapi:14,faster:17,featur:[0,5,10,16,17],fetch:15,few:[2,8,15],fi:9,field:9,figur:[0,2,4,14],file:[1,8,9,14,18],fill:[14,16],find:[8,9,14,17],finish:9,first:[0,2,8,9,14,16,17],fit:[14,16],fix:[0,8,15],flatten:0,flax:[0,16,17],flexflow:2,flexibl:[14,16],flow:8,focus:16,folder:14,follow:[0,2,5,8,9,14,16],follw:9,forc:16,force_batch_dim_to_mesh_dim:16,fork:[5,7],form:[0,2,10,14,16],forward:[0,8,16],forward_stage_layer_id:16,found:[0,4,8,9],four:[2,9],framework:[16,17],free:14,freed:17,frequent:[7,15],from:[0,1,2,9,14,15,16,17],from_pretrain:14,frontend:14,full:[0,2,10,16,17],fullfil:2,fulli:[14,17],func:15,functool:17,functorch:8,further:2,g:[0,9,14],galleri:[10,13,16,17],gb:[14,16,17],gcc:8,gener:[0,2,9,10,13,15,16,17],generate_sharded_xla_computations_argu:0,generated_str:14,get:[9,16],get_execut:17,get_model:14,get_total_allocation_s:[15,17],git:[5,8,14],github:[1,8,14],give:9,given:[14,17],global:[1,15,17],go:[9,10,14],good:14,googl:[2,5,12],got:[9,14],gpt:14,gpu:[2,9,14,15,16,17],gpus_per_nod:9,grab:9,grad:[0,15,16,17],grad_l1_x:0,grad_l2_x:0,grad_x:0,gradient:[0,15,16,17],gradual:15,graph:[0,10,15,16,17],gre:9,greatli:14,ground:[16,17],group:[2,11],gspmd:[0,2],gt:9,guarante:2,guid:[8,9,14],ha:[0,8,17],hardwar:14,hash:5,have:[2,8,9,14,15],head:[8,9,11,14],head_nod:9,head_node_ip:9,help:[1,8,12],henc:[2,9,14],here:[0,8,9,10,14,16,17],hidden_dim:[0,16,17],hierarchi:2,high:[2,17],higher:8,hlo:[0,1,2,16],hlomodul:0,host:[5,14],hostnam:9,hour:14,hous:14,how:[0,2,5,9,14,16],howev:[5,8,10,14,15,17],html:8,http:[1,8,12,14,16],huggingfac:14,hyperparamet:16,i:[0,9,16,17],icml:7,idea:0,ident:0,illustr:[2,9],ilp:1,immedi:8,implement:[2,17],importerror:8,improv:2,includ:[0,2,8,9,15,16,17],incompat:8,increas:15,index:[8,14,15],indic:[0,8],individu:[0,2],inf:[],infer:[0,14],infiniband:14,info:16,inform:8,ingest:14,init:[5,16,17],initi:17,input:[0,2,8,17],input_id:14,insert:0,insid:9,instal:[5,7,14],install_require_list:8,instanc:[9,14,16],instead:[0,9],instruct:[0,1,2,4,8,9,14],inter:[0,16],interfac:14,interfer:8,intermedi:[0,2,17],intern:17,interpret:9,intra:[0,7,16],introduc:[2,8],invar:0,invar_s:16,involv:2,io:8,iommu:8,ip:[9,14],ip_head:9,ipv4:9,ipv6:9,ipynb:[10,16,17],issu:[0,8,9,15],iter:9,its:[0,2,14],jax:[0,7,13,14,15,16,18],jaxlib:[5,17],jaxpr:[0,2,16],jinja2:14,jit:17,jit_train_step:17,jnp:[0,16,17],job:8,job_numb:9,join:14,jump:9,jupyt:[10,13,16,17],just:[9,15],k1:[16,17],k2:[16,17],k:[1,16],kernel:17,kernel_np:17,kind:0,knois:[16,17],know:[5,8,17],known:8,ksampl:[16,17],l1016:1,l172:1,l1:0,l2124:1,l2259:1,l2:0,l327:1,l408:1,l588:1,l616:[],l857:1,l967:1,languag:[0,14],larg:[7,9,10,14,15,17],larger:[15,17],largest:14,last:0,latenc:[2,16],later:[8,9,14,17],latest:[0,5,8,14],launch:[8,15],launch_model_work:14,launch_websit:14,lax:17,layer:[15,16],layer_input:0,layer_level_jaxpr_transform:0,layer_num:[15,16],layer_opt:[0,15,16],layer_output:0,lead:15,learn:[2,17],learning_r:[16,17],least:14,len:17,length:14,less:[10,17],let:[0,16],level:[2,17],lib:8,librari:[8,14],like:[0,2,5,8,9,11,14,15],limit:9,line:[9,10],linen:[16,17],link:[0,1],list:[0,2,9,17],liter:0,live:14,llm_serv:[9,14],lm:2,load:14,local:[2,5,9,14,16],local_devic:17,logic:15,logical_mesh_shap:16,longer:9,look:[2,8],loop:17,loss:[0,16,17],loss_func:[0,16,17],lot:15,lower:[2,8,15,17],m:[2,8],machin:[2,17],made:2,mai:17,main:1,mainli:[5,8],maintain:5,make:[8,9,14,15,16],manag:[2,8,9,16],mani:[0,2,8,15,16],manual:[0,14,15,17],manual_pipeline_actual_st:16,manual_pipeline_model:16,manual_pipeline_st:16,manual_pipeline_train_step:[0,16],manualpipelinemlpmodel:[0,16],manualstageopt:16,map:[0,2,17],mark:[0,16],mark_missing_vars_in_backward_computation_pipeline_mark:0,mark_pipelin:0,mark_pipeline_boundari:[0,15,16],marked_input:0,marked_output:0,marker:[0,16],materi:2,matmul:1,matrix:0,max_length:14,max_n_succ_stag:[],mb:18,md5:14,md:[4,5],mean:[0,8,9,15,16,17],meet:[8,9],megatron:2,mem:9,memori:[8,9,10,14,15],mention:9,merg:5,mesh:[0,15,16],mesh_shap:16,meta:14,metadata:15,metaseq:14,method:[0,2,14,16],micro:[0,15,16],might:[0,2,8,9],minim:[2,16],minimum:[8,9],minut:[9,10,16,17],ml:2,mlp:2,mlpmodel:[16,17],mode:8,model:[0,2,4,7,8,9,15,16,17],model_nam:14,modif:5,modifi:[5,8,9],modul:[0,8,9,16,17],moduleprofileresult:16,more:[0,2,8,10,15,16],most:[0,1,10,17],move:[0,8,15],ms:17,much:17,multipl:[0,2,9,16],n:[2,9,17],name:[9,14],navig:1,nccl:8,nccl_error_unhandled_cuda_error:8,ncclerror:8,necessari:[2,5,16],need:[0,5,8,9,14,15,16,17],nest:0,network:[0,7,8,14,17],neural:[0,7,17],new_stat:[0,16,17],newer:8,next:[2,8,9,15],nividia:8,nn:[0,16,17],node:[2,15,16],node_i:9,nodes_arrai:9,nontrivi:17,nor:14,normal:[16,17],note:[0,8,9,14,15,16],notebook:[10,13,16,17],noth:8,now:[0,2,8,9,16],np:17,npy:16,ntask:9,num:9,num_lay:17,num_micro_batch:[0,15,16],num_nod:16,number:[2,9,11,15,16,17],numpi:[14,16,17],nvcc:9,nvhpc:9,nvidia:[2,15],nvlink:2,obtain:14,offer:14,offici:8,old:9,older:9,omegaconf:14,onc:[2,9],one:[2,8,9,14,16,17],ones:[0,1,15],onli:[0,8,9,14,16,17],oom:14,op:7,open:14,oper:[0,1,2,10,15,16,17],opt:7,opt_weight:14,optax:[8,16,17],optim:[0,2,15,16,17],option:[0,16],orchestr:2,org:[8,14],org_tensorflow:8,organ:0,origin:[0,2,8,14,17],orthogon:2,os:8,osdi:2,other:[2,5,8,9],otherwis:8,our:[0,2,8],out:[0,8,9,14,16,17],output:[0,14,17],output_path:14,outvar_s:16,overal:0,overhead:2,overlap:15,override_repositori:8,overwrit:8,own:8,p3:[2,14],p:9,pack:9,packag:[8,9,14],page:[1,8,9,14],pair:2,paper:[0,2,4],paral:16,paralel:17,parallel:[0,2,7,13,14,18],parallelizedfunc:0,param:[0,16,17],paramet:[0,4,10,16,17],paramt:[16,17],parcip:2,pari:14,part:[0,2,9],parti:5,partial:[2,17],particular:8,partit:[2,9,10,16],partition:0,partition_nam:9,pass:[0,8,15,16],path:[9,14],path_to_992_shard:14,path_to_save_checkpoint:14,pci:8,peak:14,peak_memori:16,per:[0,8,9,16,17],perform:[0,2,7,8,10,14],performac:14,peripher:8,phase:0,pick:[10,14],pip3:[8,14],pip:[5,8],pipelin:[0,2,7,10,13,15,17,18],pipeline_mark:0,pipeline_p:0,pipelineinstemitt:0,pipeshard_config:0,pipeshard_parallel:[16,18],pipeshardparallel:[0,15,16],pjit:[7,13,17,18],placement:[2,11],plan:[2,5,17],playground:5,pleas:[2,5,8,9,14],pmap:[7,13,18],pmap_lib:17,pmap_train_step:17,pmean:17,point:[1,8],port:[9,14],possibl:[1,14],post:2,potenti:15,power:14,pre:[9,14],prebuilt:8,precis:2,prefix:14,preserv:0,preshard_dynamic_arg:17,press:9,pretrain:14,prettier:1,previou:9,primit:[0,15,16,17],primitive_def:0,print:[0,1,8,14,15,17],prngkei:[16,17],problem:[14,16,17],procedur:[8,14],process:[0,2,8,9,16],process_apply_gradi:0,profil:16,program:[2,8],project:[1,8,14],prompt:[9,14],protocol:8,provid:[0,2,8,9,10,14,15,17],proxi:8,pseudo:0,pt:14,publicli:14,pull:5,purg:9,purpos:17,put:[9,11,14],pwd:8,py:[0,1,8,9,10,14,16,17,18],pylint:5,pypi:8,python3:[8,9,14],python:[0,1,5,9,10,11,13,14,16,17],pytorch:14,queri:14,question:7,queu:9,queue:9,quick:[15,16],quickstart:[7,13,18],ra:9,rai:[2,8,14],ram:14,ran:12,random:[16,17],rang:[14,17],rational:2,re:8,read:[2,8,9,14],readm:[4,5],real:9,realiz:2,rebas:8,rebuild:8,recommend:[2,8],recompil:8,record:12,recurs:[5,8],redirect:8,reduc:17,reduct:8,refer:9,regardless:8,registernumpybfloat16:8,registr:1,regularli:8,reinstal:8,relat:0,reli:[8,15],relu:[0,16,17],remateri:0,remov:0,repeat:17,repetit:15,replac:15,replic:17,repo:[5,8,14],report:15,repositori:[5,8],repres:[0,2],represent:[2,17],reproduc:[4,15],request:[5,8,14],requir:[0,2,8,10,16,17],reserach:12,reshap:17,resid:5,resourc:[8,14,16],respect:15,rest:0,result:[0,4,9,16,17],return_tensor:14,review:5,rf:8,right:0,rm:8,rngkei:[16,17],roughli:9,run:[0,2,5,8,10,11,15,16,17],run_alpa_on_slurm:9,run_auto_sharding_pass:[0,1],runautoshardingpass:0,runtim:0,runtime_execut:17,runtimeerror:8,s:[0,2,5,8,9,14,15,17],sai:14,same:[0,8,9,10,14,16,17],save:[14,16],scale:[4,7,17],scatter:1,schedul:[0,2,15],scheme:[2,17],scontrol:9,script:[5,10,11,14,15,16,17],second:[10,16,17],section:[4,8,9,14],secur:8,see:[0,5,8,9,11,14,15,17],self:[0,16,17],send:[2,5,15],sent:0,separ:[0,8,16],seper:[],sequenc:14,sequenti:0,serial:17,serial_execut:17,serv:7,servic:[1,5,14],set:[0,1,2,8,9,15],setup:[8,14],sever:[2,10,16],sh:[5,9],shape:[15,17],shard:[2,7,13,14,15,18],shard_batch:17,shard_each_stag:0,shard_parallel:1,shardeddevicearrai:17,shardparallel:15,share:[8,9,14],shell:9,should:[0,5,8,9,11,14,15,16],show:[0,2,4,9,14,16,17],shown:[0,2],shutdown:16,side:1,signific:15,silent:8,similar:[8,14,17],similarli:9,simpl:[8,15,17],simpler:0,simpli:[0,14],sinc:8,singl:[0,2,10,14,15],site:12,size:[0,14,15,17],skip:14,skip_special_token:14,slack:14,sleep:9,slice:[0,2,15,16],slice_closed_jaxpr_by_full_pipeline_mark:0,sliceautoshardedstag:0,slide:[2,12],slow:14,slurm:7,slurm_cpus_per_task:9,slurm_job_nodelist:9,slurm_job_num_nod:9,small:15,smaller:[0,2,14],smi:15,snippet:0,so:[0,5,8,9,14,15,16,17],solv:[9,16,17],solver:7,some:[0,2,8,9,11,14,15,17],some_jax_oper:0,sometim:[8,9],sourc:[5,10,13,14,16,17],space:14,spawn:[8,9],special:0,specif:[0,1,8,9,14,16,17],specifi:[0,8,9,14,16,17],sphinx:[10,13,16,17],split:[0,9,16,17],split_compute_grad_and_apply_grad:0,split_donate_invar:0,spmd:[0,1,5],squeue:9,srun:[8,9],stage:16,stage_opt:16,standard:8,star:7,start:[0,1,2,8,9,11,14,15,16],state:[0,15,16,17],statu:[9,14],std:17,step:[0,2,5,8,9,14,16,17],step_2_consolidate_992_shards_to_singleton:14,step_3_convert_to_numpy_weight:14,still:17,stop:9,store:[5,15,17],strategi:[2,10,14,16,17],strictli:8,structur:[0,7],style:5,subgraph:2,subject:14,submesh:[0,16],submesh_choic:16,submit:[5,15],subset:[0,16],successfulli:14,suffici:14,suffix:8,suitabl:10,sum:0,summar:[0,9],summari:[9,10],support:[8,10,14,16],sure:[8,9,14,15],sync_func:17,synchron:15,synchronize_all_act:17,syntax:9,system:[2,7,8,9,14],t:[0,9],tabl:10,tag:8,tailor:17,take:[0,2,8,9,14,16,17],talk:2,target:[9,17],task:[0,8,9],team:12,techniqu:[2,10,17],tell:[9,14],temp_buffer_s:16,tensor:[2,15,17],tensorflow:[1,8],term:2,termin:[9,14],test:[1,3,9,16,17],test_bas:1,test_complet:14,test_instal:8,test_simpl:8,text:9,textgen:[9,14],textgen_multinode_test:9,textgen_uninode_test:9,than:[8,9,10,17],thank:8,thei:[2,14,17],them:[0,2,9,10,17],therefor:[9,17],thi:[0,1,2,4,5,8,9,10,11,12,14,15,16,17],thin:0,thing:[9,17],think:15,third:[2,5],third_parti:[5,8],those:[2,8,15],thread:8,three:2,through:[2,7,8,9],ti:0,time:[8,9,10,16,17],tip:[14,15],todo:[2,10],tofu:2,togeth:9,toi:16,token:14,too:14,tool:[9,10],toolkit:8,top:[2,17],topic:12,topolog:9,torch:[8,14],torch_frontend:8,torchaudio:14,torchdistx:8,torchvis:14,total:[10,14,16,17,18],total_allocation_s:17,trace:0,traffic:8,train:[0,2,4,7,10,12,13,14,18],train_stat:[16,17],train_step:[16,17],trainstat:[16,17],tranform:17,transform:[0,10,14,17],tree:1,tree_map:17,tri:2,tricki:15,trigger:16,troubl:[8,14],truth:[16,17],tune:[7,14],tutori:[5,10,14,15,16,17,18],tutorials_jupyt:13,tutorials_python:13,twice:14,two:[0,2,8,10,14,16],tx:[16,17],type:[0,9,17],typic:[0,8],u:9,umath:8,under:[1,8,14],understand:[2,12,15],unexpect:15,unifi:2,uninstal:8,uniqu:14,unit:1,unlik:[2,17],up:[0,8,9],updat:[0,8],upgrad:8,upper:2,upstream:8,url:[8,14],us:[0,2,5,7,10,15,16,17],usag:[8,14,15],user:[0,2,8,9,14,15,16,17],usual:9,util:[14,16,17],uvicorn:14,v001:9,v0:1,v100:9,valu:[8,9,15],value_and_grad:15,variabl:[0,1,9,11],variant:2,variou:1,verfi:9,veri:12,verifi:14,version:[0,5,9,14],via:[0,5,8,14],view:[2,12,16],virtual:8,visual:0,vt:8,vulner:8,w:[9,16,17],wai:[1,9,10],walk:[2,7],want:[5,8,9,14,16,17],warmup:17,warn:15,we:[0,2,5,8,9,10,14,15,16,17],websit:14,weight:8,well:[2,9,17],what:2,wheel:14,when:[0,2,8,9,16],where:[0,1,9],whether:8,which:[0,2,5,9,10,12,14,16,17],whl:[8,14],whole:[0,16],whose:5,wise:15,within:[0,9],without:[8,9,14,17],work:[8,9,10,11,14,15,17],worker:[9,14,15,16],worker_num:9,workflow:[0,2,9],workload:10,wrapper:[0,14],write:[8,14,17],wrote:0,wx:[16,17],x:[0,2,14,16,17],xla:[0,1,2,5,8,17],xla_extens:17,xmap:17,y:[0,8,16,17],yapf:5,ye:10,you:[0,1,2,5,8,9,11,14,15,16,17],your:[8,9,14,15,17],your_user_nam:9,zero2parallel:15,zip:13},titles:["Alpa Compiler Walk-Through","Code Structure of the Intra-op Solver","Design and Architecture","Rationale","Performance Benchmark","Developer Guide","Alpa Tutorials","Alpa Documentation","Install Alpa","Using Alpa on Slurm","Differences between alpa.parallelize, jax.pmap and jax.pjit","Frequently Asked Questions (FAQ)","ICML\u201922 Big Model Tutorial","Alpa Tutorials","Serving OPT-175B using Alpa","Performance Tuning Guide","Distributed Training with Both Shard and Pipeline Parallelism","Alpa Quickstart","Computation times"],titleterms:{"1":[8,11],"175b":14,"2":[8,11],"22":12,"3":11,"import":[2,16,17],against:17,alpa:[0,5,6,7,8,9,10,11,13,14,17],an:[16,17],architectur:[2,7],argument:11,ask:11,assign:16,auto:[0,17],automat:16,benchmark:[4,7],between:10,big:12,both:16,check:[8,9],choos:15,cluster:[2,16],code:[1,5],command:14,compar:10,comparison:17,compil:[0,2],comput:[2,18],concept:2,connect:16,construct:0,contribut:5,control:11,convert:14,copi:14,creat:9,cuda:8,cuda_visible_devic:11,data:[10,17],debug:1,demo:14,depend:9,design:2,develop:[5,7],devic:[2,11,16,17],differ:10,distribut:16,document:7,enter:9,environ:[9,16],error:8,exampl:1,execut:17,exit:9,faq:11,featur:11,flax:8,format:[5,14],frequent:11,from:8,frontend:8,gener:14,get:7,gpu:[8,11],graph:2,guid:[5,7,15],hang:8,how:[1,11],icml:12,improv:14,init:11,initi:16,inspect:1,instal:[8,9],inter:2,interact:9,intra:[1,2],jax:[8,10,17],jaxlib:8,job:9,kei:1,launch:14,layer:0,learn:1,librari:[16,17],licens:14,line:14,lint:5,load:9,manual:16,memori:17,mesh:2,method:[8,11,15],mlp:[16,17],mode:9,model:[10,12,14],multi:[8,9],multipl:14,node:[8,9,14],numpi:8,op:[1,2],opt:14,option:[8,9],orchestratoin:2,organ:5,other:[11,14],output:9,overhead:15,overview:[2,14],parallel:[10,15,16,17],pass:2,perform:[4,15],pipelin:16,pjit:10,pmap:[10,17],pointer:1,prefer:10,prerequisit:[8,9],problem:8,python:8,pytorch:8,question:11,quickstart:17,rai:[9,11,16],rational:3,read:1,reduc:15,requir:[9,14],reshard:2,resourc:9,run:[1,9,14],runtim:[2,15],sampl:9,sbatch:9,script:9,serv:14,server:14,session:9,setup:9,shard:[0,1,16],simpl:1,singl:[9,16,17],slurm:[8,9],softwar:9,solver:1,some:1,sourc:8,speed:[14,17],stage:[0,2],start:7,startup:9,strategi:1,structur:1,submit:9,submodul:5,tensorflow:5,test:[5,8],through:0,time:18,train:[16,17],troubleshoot:8,tune:15,tutori:[6,7,12,13],unhandl:8,unit:5,updat:5,us:[8,9,11,14],usag:17,version:8,virtual:9,walk:0,web:14,weight:14,wheel:8,when:10,worker:2,xmap:10}})